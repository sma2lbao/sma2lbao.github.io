{"version":3,"sources":["../node_modules/@material-ui/icons/esm/GitHub.js","views/auth/Login/modules/SignIn.tsx","views/auth/Login/modules/SignUp.tsx","views/auth/Login/modules/Swiper.tsx","views/auth/Login/index.tsx"],"names":["createSvgIcon","createElement","d","SignIn","RouterHelper","useRouterHelper","usePlatformAuthWayQuery","queryData","data","queryLoading","loading","console","log","enqueueSnackbar","useSnackbar","useLoginMutation","onCompleted","localStorage","setItem","login","gotoHome","onError","error","React","username","setUsername","password","setPassword","TextField","id","label","value","onChange","e","target","placeholder","fullWidth","margin","type","Button","variant","onClick","variables","disabled","platform_auth_way","map","item","idx","key","IconButton","platform","url","targetOrigin","process","REACT_APP_HTTP_DOMAIN_URL","child","window","open","timer","setInterval","postMessage","addEventListener","event","clearInterval","close","access_token","thirdLogin","GitHub","email","setEmail","code","setCode","useHasUsernameQuery","useSendRegisterEmailMutation","send_register_email","useCreateUserWithCodeMutation","create_user_with_code","required","Box","user","AutoPlaySwipeableViews","autoPlay","SwipeableViews","useStyles","makeStyles","theme","createStyles","image","width","height","Swiper","props","classes","images","enableMouseEvents","index","i","className","Image","src","defaultProps","root","fontSize","overflow","left","flex","backgroundColor","palette","primary","main","right","background","paper","display","alignItems","justifyContent","Login","tag","setTag","_"],"mappings":"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","file":"static/js/13.1a3565b3.chunk.js","sourcesContent":["import React from 'react';\nimport createSvgIcon from './utils/createSvgIcon';\nexport default createSvgIcon(React.createElement(\"path\", {\n  d: \"M12 .3a12 12 0 0 0-3.8 23.4c.6.1.8-.3.8-.6v-2c-3.3.7-4-1.6-4-1.6-.6-1.4-1.4-1.8-1.4-1.8-1-.7.1-.7.1-.7 1.2 0 1.9 1.2 1.9 1.2 1 1.8 2.8 1.3 3.5 1 0-.8.4-1.3.7-1.6-2.7-.3-5.5-1.3-5.5-6 0-1.2.5-2.3 1.3-3.1-.2-.4-.6-1.6 0-3.2 0 0 1-.3 3.4 1.2a11.5 11.5 0 0 1 6 0c2.3-1.5 3.3-1.2 3.3-1.2.6 1.6.2 2.8 0 3.2.9.8 1.3 1.9 1.3 3.2 0 4.6-2.8 5.6-5.5 5.9.5.4.9 1 .9 2.2v3.3c0 .3.1.7.8.6A12 12 0 0 0 12 .3\"\n}), 'GitHub');","import * as React from \"react\";\nimport { TextField, Button, IconButton } from \"@material-ui/core\";\nimport { useSnackbar } from \"notistack\";\n// import { GitHub } from \"@material-ui/icons\";\nimport { useLoginMutation, usePlatformAuthWayQuery } from \"@/schema\";\nimport { useRouterHelper } from \"@/hooks\";\nimport { GitHub } from \"@material-ui/icons\";\n\nexport default function SignIn() {\n  const RouterHelper = useRouterHelper();\n\n  const { data: queryData, loading: queryLoading } = usePlatformAuthWayQuery();\n  console.log(queryData, queryLoading);\n  const { enqueueSnackbar } = useSnackbar();\n  const [login, res] = useLoginMutation({\n    onCompleted(data) {\n      enqueueSnackbar(\"登录成功\");\n      localStorage.setItem(\"access_token\", data?.login);\n      RouterHelper.gotoHome();\n    },\n    onError(error) {\n      console.log(error);\n    }\n  });\n  const { loading } = res;\n\n  const [username, setUsername] = React.useState(\"\");\n  const [password, setPassword] = React.useState(\"\");\n\n  const _signIn = function() {\n    login({ variables: { username, password } });\n  };\n\n  const thirdLogin = function(platform: string, url: string) {\n    const targetOrigin = process.env.REACT_APP_HTTP_DOMAIN_URL || \"\";\n    const child = window.open(\n      targetOrigin + url,\n      platform,\n      `width=450,height=450,toolbar=0,menubar=0,location=0,status=0`\n    );\n    if (child) {\n      const timer = setInterval(() => {\n        child.postMessage(\n          {\n            type: \"access_token\"\n          },\n          targetOrigin\n        );\n      }, 1000);\n\n      window.addEventListener(\"message\", event => {\n        const data = event.data;\n        if (data && data.type === \"access_token_callback\") {\n          clearInterval(timer);\n          child && child.close();\n\n          enqueueSnackbar(\n            data.data.access_token ? \"登录成功\" : data.data.error || \"登录失败\"\n          );\n          localStorage.setItem(\"access_token\", data.data.access_token);\n          // history.push(\"/home\");\n          RouterHelper.gotoHome();\n        }\n      });\n    }\n  };\n\n  return (\n    <div>\n      <form>\n        <TextField\n          id=\"username\"\n          label=\"用户名\"\n          value={username}\n          onChange={e => setUsername(e.target.value)}\n          placeholder=\"请输入用户名\"\n          fullWidth\n          margin=\"normal\"\n        />\n        <TextField\n          id=\"password\"\n          label=\"密码\"\n          type=\"password\"\n          value={password}\n          onChange={e => setPassword(e.target.value)}\n          placeholder=\"请输入密码\"\n          fullWidth\n          margin=\"normal\"\n        />\n        <Button variant=\"contained\" onClick={_signIn} disabled={loading}>\n          {loading ? \"登录中\" : \"登录\"}\n        </Button>\n      </form>\n      {queryData?.platform_auth_way.map((item, idx) => {\n        return (\n          <div key={idx}>\n            <IconButton onClick={() => thirdLogin(item.platform, item.url)}>\n              <GitHub />\n            </IconButton>\n          </div>\n        );\n      })}\n      {/* <IconButton >\n        <GitHub />\n      </IconButton> */}\n    </div>\n  );\n}\n","import * as React from \"react\";\nimport { TextField, Button, Box } from \"@material-ui/core\";\nimport { useSnackbar } from \"notistack\";\nimport {\n  useHasUsernameQuery,\n  useSendRegisterEmailMutation,\n  useCreateUserWithCodeMutation\n} from \"@/schema\";\n\nexport default function SignIn() {\n  const { enqueueSnackbar } = useSnackbar();\n  const [username, setUsername] = React.useState(\"\");\n  const [password, setPassword] = React.useState(\"\");\n  const [email, setEmail] = React.useState(\"\");\n  const [code, setCode] = React.useState(\"\");\n\n  const { data, loading } = useHasUsernameQuery({\n    variables: {\n      username: username\n    }\n  });\n  console.log(\"_changeUsername: \", username, data, loading);\n\n  // 发送验证码\n  const [send_register_email] = useSendRegisterEmailMutation({\n    onCompleted(data) {\n      console.log(data);\n      enqueueSnackbar(\"发送成功\");\n    },\n    onError(error) {\n      console.error(error);\n      enqueueSnackbar(\"发送失败\");\n    }\n  });\n  const _sendVerifyCode = function() {\n    send_register_email({ variables: { email: email } });\n  };\n\n  // 注册\n  const [create_user_with_code] = useCreateUserWithCodeMutation({\n    onError(error) {\n      console.error(error);\n      enqueueSnackbar(\"注册失败\");\n    },\n    onCompleted(data) {\n      console.log(data);\n      enqueueSnackbar(\"注册成功\");\n    }\n  });\n  const _signUp = function() {\n    create_user_with_code({\n      variables: {\n        user: {\n          username,\n          password,\n          email,\n          code\n        }\n      }\n    });\n  };\n\n  const _changeUsername = (\n    e: React.ChangeEvent<HTMLTextAreaElement | HTMLInputElement>\n  ) => {\n    setUsername(e.target.value);\n  };\n\n  return (\n    <div>\n      <form>\n        <TextField\n          id=\"username\"\n          label=\"用户名\"\n          required\n          value={username}\n          onChange={_changeUsername}\n          placeholder=\"请输入用户名\"\n          fullWidth\n          margin=\"normal\"\n        />\n        <TextField\n          id=\"password\"\n          label=\"密码\"\n          type=\"password\"\n          required\n          value={password}\n          onChange={e => setPassword(e.target.value)}\n          placeholder=\"请输入密码\"\n          fullWidth\n          margin=\"normal\"\n        />\n        <TextField\n          id=\"email\"\n          label=\"邮箱\"\n          type=\"email\"\n          required\n          value={email}\n          onChange={e => setEmail(e.target.value)}\n          placeholder=\"请输入邮箱\"\n          fullWidth\n          margin=\"normal\"\n        />\n        <Box>\n          <TextField\n            id=\"code\"\n            label=\"验证码\"\n            value={code}\n            onChange={e => setCode(e.target.value)}\n            placeholder=\"请输入验证码\"\n            margin=\"normal\"\n          />\n          <Button variant=\"contained\" onClick={_sendVerifyCode}>\n            获取验证码\n          </Button>\n        </Box>\n        <Button variant=\"contained\" fullWidth onClick={_signUp}>\n          注册\n        </Button>\n      </form>\n    </div>\n  );\n}\n","import * as React from \"react\";\nimport SwipeableViews from \"react-swipeable-views\";\nimport { autoPlay } from \"react-swipeable-views-utils\";\nimport Image from \"@/components/base/Image\";\nimport { makeStyles, createStyles, Theme } from \"@material-ui/core/styles\";\n\nconst AutoPlaySwipeableViews = autoPlay(SwipeableViews);\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    image: {\n      width: \"100%\",\n      height: \"100%\"\n    }\n  })\n);\n\ninterface SwiperProps {\n  images: string[];\n}\n\nfunction Swiper(props: SwiperProps) {\n  const classes = useStyles();\n  const { images } = props;\n\n  return (\n    <div>\n      <AutoPlaySwipeableViews enableMouseEvents index={0}>\n        {images.map((item, i) => {\n          return (\n            <div className={classes.image} key={i}>\n              <Image src={item} />\n            </div>\n          );\n        })}\n      </AutoPlaySwipeableViews>\n    </div>\n  );\n}\n\nSwiper.defaultProps = {\n  images: [\n    \"https://pic1.zhimg.com/v2-cc17d8b31fe162fdbfadba1d18b7836e_1200x500.jpg\",\n    \"http://n.sinaimg.cn/collect/crawl/20160224/ZFh0-fxprucv9824132.jpg\"\n  ]\n} as Partial<SwiperProps>;\n\nexport default Swiper;\n","import * as React from \"react\";\nimport { SignIn, SignUp, Swiper } from \"./modules\";\nimport { Button, Box } from \"@material-ui/core\";\nimport { makeStyles, Theme, createStyles } from \"@material-ui/core/styles\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      width: \"100%\",\n      height: \"100vh\",\n      fontSize: 0,\n      overflow: \"hidden\"\n    },\n    left: {\n      flex: 1,\n      backgroundColor: theme.palette.primary.main\n    },\n    right: {\n      flex: 1,\n      backgroundColor: theme.palette.background.paper,\n      display: \"flex\",\n      alignItems: \"center\",\n      justifyContent: \"center\"\n    },\n    main: {\n      width: 300\n    }\n  })\n);\n\nexport default function Login() {\n  const classes = useStyles();\n  const [tag, setTag] = React.useState(0);\n\n  return (\n    <Box className={classes.root} display=\"flex\">\n      <div className={classes.left}>\n        <Swiper />\n      </div>\n      <div className={classes.right}>\n        <div className={classes.main}>\n          <Button onClick={_ => setTag(0)}>登录</Button>\n          <Button onClick={_ => setTag(1)}>注册</Button>\n          <div>\n            {tag === 0 && <SignIn />}\n            {tag === 1 && <SignUp />}\n          </div>\n        </div>\n      </div>\n    </Box>\n  );\n}\n"],"sourceRoot":""}