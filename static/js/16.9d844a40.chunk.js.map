{"version":3,"sources":["components/app/Player/ShadowPlayer.tsx","components/app/Player/index.ts","views/shadows/ShadowPlay/modules/Comment/CommentItem.tsx","views/shadows/ShadowPlay/modules/Comment/AddComment.tsx","views/shadows/ShadowPlay/modules/Comment/index.tsx","views/shadows/ShadowPlay/modules/NextPlay/index.tsx","views/shadows/ShadowPlay/modules/VideoInfo/index.tsx","views/shadows/ShadowPlay/modules/VideoPlayer/Progress.tsx","views/shadows/ShadowPlay/modules/VideoPlayer/Volume.tsx","views/shadows/ShadowPlay/modules/VideoPlayer/player.interface.ts","views/shadows/ShadowPlay/modules/VideoPlayer/Tool.tsx","views/shadows/ShadowPlay/modules/VideoPlayer/SettingPanel.tsx","views/shadows/ShadowPlay/modules/VideoPlayer/index.tsx","views/shadows/ShadowPlay/index.tsx"],"names":["useStyles","makeStyles","theme","createStyles","root","width","paddingTop","position","player","height","top","left","ShadowPlayer","props","classes","url","rest","className","defaultProps","controls","avatar","marginRight","spacing","main","flex","infoItem","marginLeft","commentText","marginTop","CommentItem","Box","display","Avatar","justifyContent","alignItems","Typography","variant","AddComment","React","content","setContent","Input","value","onChange","e","target","placeholder","Button","onClick","onSubmit","disabled","item","padding","borderTop","palette","divider","commentTitle","Comment","ShadowPlayContext","shadowMedium","type_id","id","useReviewsPaginatedQuery","variables","query","last","type","ReviewMedium","Medium","skip","data","loading","fetchMore","error","useCreateReviewMutation","applyComment","text","review","reviews_paginated","edges","length","map","edge","key","cursor","pageInfo","hasNextPage","after","endCursor","updateQuery","previousQueryResult","fetchMoreResult","totalCount","__typename","color","SpecialBox","NextPlay","useParams","useShadowNextUrgesByShadowQuery","shadow_id","py","gutterBottom","shadow_next_urges_by_shadow","GridList","cellHeight","cols","idx","GridListTile","Media","Placeholder","title","header","marginBottom","toolBox","toolText","description","VideoInfo","shadowPlayQuery","useFollowHelper","owner_uid","shadow","author","uid","following","toggleFollow","useCreateOrUpdateVoteMutation","create_or_update_vote","handleVote","vote","medium_id","status","VoteStatus","Likd","moment","create_at","format","IconButton","size","ThumbDownAlt","fontSize","ThumbUpAlt","MoreVert","src","ml","nickname","Progress","duration","currentTime","formatHandler","hh","hours","mm","minutes","ss","seconds","padStart","durationFormat","Slider","min","max","valueLabelDisplay","valueLabelFormat","val","onMouseMove","Volume","volume","muted","onClickMuted","onVolumeChange","anchorRef","open","setOpen","ref","onMouseEnter","onMouseLeave","VolumeOffRounded","VolumeMuteRounded","VolumeDownRounded","VolumeUpRounded","Popper","placement","anchorEl","current","transition","disablePortal","style","step","orientation","PlayRate","MediaType","PlayStatus","Tool","onPlay","onPause","Ready","Pause","PlayArrow","Playing","Waiting","SlowMotionVideo","minHeight","backgroundColor","SettingPanel","background","ClickAwayListener","onClickAway","console","log","setting","wrap","bottom","right","VideoPlayer","mediaType","onDurationChange","onTimeUpdate","onProgress","onLoadedMetadata","onRateChange","onWaiting","onPlaying","onEnded","onError","onCanPlay","videoRef","openSetting","setOpenSetting","Loading","playbackRate","cache","videoInfo","setVideoInfo","M3U8","source","hls","Hls","loadSource","attachMedia","Ended","Error","currentTarget","buffered","end","play","pause","num","result","seek","Settings","autoPlay","controlsList","loop","playsInline","preload","body","paper","margin","borderRight","aider","overflow","undefined","ShadowPlay","setShadowMedium","useShadowQuery","sources","Provider","sticky"],"mappings":"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","file":"static/js/16.9d844a40.chunk.js","sourcesContent":["import * as React from \"react\";\nimport ReactPlayer, { ReactPlayerProps } from \"react-player\";\nimport { makeStyles, createStyles, Theme } from \"@material-ui/core/styles\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      width: \"100%\",\n      paddingTop: \"calc(56.25%)\",\n      position: \"relative\"\n    },\n    player: {\n      width: \"100% !important\",\n      height: \"100% !important\",\n      position: \"absolute\",\n      top: 0,\n      left: 0\n    }\n  })\n);\n\nexport interface PlayerBaseProps\n  extends Pick<\n    ReactPlayerProps,\n    \"url\" | \"playing\" | \"controls\" | \"muted\" | \"wrapper\" | \"light\"\n  > {}\n\nexport const ShadowPlayer: React.FC<PlayerBaseProps> = props => {\n  const classes = useStyles();\n  const { url, ...rest } = props;\n\n  return (\n    <div className={classes.root}>\n      <ReactPlayer {...rest} className={classes.player} url={url} />\n    </div>\n  );\n};\n\nShadowPlayer.defaultProps = {\n  controls: true\n};\n\nexport default ShadowPlayer;\n","export * from \"./ShadowPlayer\";\n","import * as React from \"react\";\nimport {\n  Box,\n  Typography,\n  Avatar,\n  makeStyles,\n  createStyles,\n  Theme\n} from \"@material-ui/core\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    avatar: {\n      marginRight: theme.spacing(2)\n    },\n    main: {\n      flex: 1\n    },\n    infoItem: {\n      \"& + &\": {\n        marginLeft: theme.spacing(2)\n      }\n    },\n    commentText: {\n      marginTop: theme.spacing(1)\n    }\n  })\n);\n\nfunction CommentItem() {\n  const classes = useStyles();\n\n  return (\n    <Box>\n      <Box display=\"flex\">\n        <Avatar className={classes.avatar}>L</Avatar>\n        <div className={classes.main}>\n          <Box\n            display=\"flex\"\n            justifyContent=\"space-between\"\n            alignItems=\"center\"\n          >\n            <Typography>昵称</Typography>\n            <Typography variant=\"caption\">2020年10月01日</Typography>\n          </Box>\n          <Box display=\"flex\">\n            <Typography variant=\"caption\" className={classes.infoItem}>\n              like 2\n            </Typography>\n            <Typography variant=\"caption\" className={classes.infoItem}>\n              dislike 0\n            </Typography>\n          </Box>\n        </div>\n      </Box>\n      <Typography variant=\"body2\" className={classes.commentText}>\n        你的评论内容。你的评论内容。你的评论内容。你的评论内容。你的评论内容。你的评论内容。\n      </Typography>\n    </Box>\n  );\n}\n\nexport default CommentItem;\n","import * as React from \"react\";\nimport { Input, Button } from \"@material-ui/core\";\n\nexport interface AddCommentProps {\n  onSubmit?: (text: string) => void;\n}\n\nexport const AddComment = (props: AddCommentProps) => {\n  const [content, setContent] = React.useState<string>(\"\");\n\n  const handleSend = () => {\n    props.onSubmit && props.onSubmit(content);\n  };\n\n  return (\n    <div>\n      <Input\n        value={content}\n        onChange={e => setContent(e.target.value)}\n        placeholder=\"\"\n      />\n      <Button onClick={handleSend} disabled={!!content}>\n        Send\n      </Button>\n    </div>\n  );\n};\n\nexport default AddComment;\n","import * as React from \"react\";\nimport { Box, Typography, Button } from \"@material-ui/core\";\nimport CommentItem from \"./CommentItem\";\nimport AddComment from \"./AddComment\";\nimport { makeStyles, createStyles, Theme } from \"@material-ui/core/styles\";\nimport {\n  useReviewsPaginatedQuery,\n  ReviewMedium,\n  useCreateReviewMutation\n} from \"@/schema\";\nimport { SpecialBox } from \"@/components/public/SpecialBox\";\nimport { ShadowPlayContext } from \"../..\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    item: {\n      padding: theme.spacing(2, 0),\n      \"& + &\": {\n        borderTop: `1px solid ${theme.palette.divider}`\n      }\n    },\n    commentTitle: {\n      padding: theme.spacing(1, 0)\n    }\n  })\n);\n\nexport default function Comment() {\n  const classes = useStyles();\n  const [, shadowMedium] = React.useContext(ShadowPlayContext);\n  let type_id = shadowMedium ? +shadowMedium?.id : -1;\n  const { data, loading, fetchMore, error } = useReviewsPaginatedQuery({\n    variables: {\n      query: {\n        last: 16\n      },\n      type: ReviewMedium.Medium,\n      type_id\n    },\n    skip: type_id === -1\n  });\n\n  const loadMore = () => {\n    fetchMore({\n      variables: {\n        type: ReviewMedium.Medium,\n        type_id,\n        query: {\n          last: 8,\n          after: data?.reviews_paginated.pageInfo.endCursor\n        }\n      },\n      updateQuery: (previousQueryResult, { fetchMoreResult }) => {\n        if (fetchMoreResult?.reviews_paginated?.edges) {\n          const {\n            edges,\n            pageInfo,\n            totalCount\n          } = fetchMoreResult.reviews_paginated;\n          return {\n            reviews_paginated: {\n              pageInfo,\n              totalCount,\n              edges: [...previousQueryResult.reviews_paginated.edges, ...edges],\n              __typename: previousQueryResult.reviews_paginated.__typename\n            }\n          };\n        }\n        return previousQueryResult;\n      }\n    });\n  };\n\n  const [applyComment] = useCreateReviewMutation();\n\n  const handleSubmit = (text: string) => {\n    applyComment({\n      variables: {\n        review: {\n          content: text,\n          type: ReviewMedium.Medium,\n          type_id\n        }\n      }\n    });\n  };\n\n  return (\n    <Box>\n      <AddComment onSubmit={handleSubmit} />\n      <Typography variant=\"subtitle2\" className={classes.commentTitle}>\n        {/* 评论 */}\n      </Typography>\n      <div>\n        {data?.reviews_paginated?.edges?.length ? (\n          <div>\n            {data?.reviews_paginated?.edges?.map((edge: any) => {\n              return (\n                <div key={edge.cursor}>\n                  <CommentItem />\n                </div>\n              );\n            })}\n            {data?.reviews_paginated?.pageInfo?.hasNextPage && (\n              <Button onClick={loadMore} disabled={loading}>\n                <Typography color=\"textSecondary\" variant=\"caption\">\n                  {loading ? \"加载中...\" : \"加载更多\"}\n                </Typography>\n              </Button>\n            )}\n          </div>\n        ) : (\n          <SpecialBox error={!!error} loading={loading} placeholder />\n        )}\n      </div>\n    </Box>\n  );\n}\n","import * as React from \"react\";\nimport { MediaNormal } from \"@/components/app/Media\";\nimport { GridList, GridListTile, Typography, Box } from \"@material-ui/core\";\nimport { useShadowNextUrgesByShadowQuery } from \"@/schema\";\nimport { useParams } from \"react-router-dom\";\nimport Placeholder from \"@/components/base/Placeholder\";\n\nexport default function NextPlay() {\n  const { id } = useParams();\n  const { data, error, loading } = useShadowNextUrgesByShadowQuery({\n    variables: {\n      shadow_id: id\n    }\n  });\n  if (loading) {\n    return <div>loading</div>;\n  }\n  if (error) {\n    return <div>error</div>;\n  }\n  return (\n    <Box py={2}>\n      <Typography variant=\"subtitle1\" gutterBottom>\n        接下来播放\n      </Typography>\n      {data?.shadow_next_urges_by_shadow.length ? (\n        <GridList cellHeight=\"auto\" cols={4}>\n          {data.shadow_next_urges_by_shadow.map((item, idx) => {\n            return (\n              <GridListTile cols={1} key={idx}>\n                <MediaNormal {...item} />\n              </GridListTile>\n            );\n          })}\n        </GridList>\n      ) : (\n        <div>\n          <Placeholder title=\"暂无可播放资源\" />\n        </div>\n      )}\n    </Box>\n  );\n}\n","import * as React from \"react\";\nimport { makeStyles, createStyles, Theme } from \"@material-ui/core/styles\";\nimport { Typography, Box, IconButton, Avatar, Button } from \"@material-ui/core\";\nimport { ThumbUpAlt, ThumbDownAlt, MoreVert } from \"@material-ui/icons\";\nimport { ShadowPlayContext } from \"../..\";\nimport moment from \"moment\";\nimport { useFollowHelper } from \"@/hooks\";\nimport { useCreateOrUpdateVoteMutation, VoteStatus } from \"@/schema\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {},\n    header: {\n      display: \"flex\",\n      justifyContent: \"space-between\",\n      marginBottom: theme.spacing(1)\n    },\n    infoItem: {\n      \"& + &\": {\n        marginLeft: theme.spacing(1)\n      }\n    },\n    toolBox: {\n      display: \"flex\",\n      alignItems: \"center\",\n      marginRight: theme.spacing(2)\n    },\n    toolText: {\n      marginLeft: theme.spacing(0.5)\n    },\n    description: {\n      marginBottom: theme.spacing(1)\n    }\n  })\n);\n\nexport default function VideoInfo() {\n  const classes = useStyles();\n  const [shadowPlayQuery, shadowMedium] = React.useContext(ShadowPlayContext);\n  const { following, toggleFollow } = useFollowHelper({\n    owner_uid: shadowPlayQuery?.shadow.author.uid as string\n  });\n  const [create_or_update_vote] = useCreateOrUpdateVoteMutation();\n\n  const handleVote = () => {\n    create_or_update_vote({\n      variables: {\n        vote: {\n          medium_id: shadowMedium ? +shadowMedium.id : -1,\n          status: VoteStatus.Likd\n        }\n      }\n    });\n  };\n\n  return (\n    <div>\n      <Box className={classes.header}>\n        <div>\n          <Typography variant=\"subtitle1\">\n            {shadowPlayQuery?.shadow.title}\n          </Typography>\n          <Box display=\"flex\">\n            <Typography variant=\"caption\" className={classes.infoItem}>\n              观看: TODO\n            </Typography>\n            <Typography variant=\"caption\" className={classes.infoItem}>\n              发布时间:{\" \"}\n              {moment(shadowPlayQuery?.shadow.create_at).format(\n                \"YYYY-MM-DD HH:mm\"\n              )}\n            </Typography>\n          </Box>\n        </div>\n        <Box display=\"flex\" alignItems=\"center\">\n          <Box className={classes.toolBox}>\n            <IconButton size=\"small\" onClick={handleVote}>\n              <ThumbDownAlt fontSize=\"small\" />\n            </IconButton>\n            <Typography className={classes.toolText}>TODO</Typography>\n          </Box>\n          <Box className={classes.toolBox}>\n            <IconButton size=\"small\" onClick={handleVote}>\n              <ThumbUpAlt fontSize=\"small\" />\n            </IconButton>\n            <Typography className={classes.toolText}>TODO</Typography>\n          </Box>\n          <IconButton size=\"small\">\n            <MoreVert fontSize=\"small\" />\n          </IconButton>\n        </Box>\n      </Box>\n      <Typography className={classes.description} variant=\"body2\">\n        {shadowPlayQuery?.shadow.description}\n      </Typography>\n\n      <Box display=\"flex\" justifyContent=\"space-between\" alignItems=\"center\">\n        <Box display=\"flex\" alignItems=\"center\">\n          <Avatar src={shadowPlayQuery?.shadow.author.avatar}></Avatar>\n          <Box ml={1}>\n            <Typography variant=\"subtitle2\">\n              {shadowPlayQuery?.shadow.author.nickname}\n            </Typography>\n            <Typography variant=\"caption\">\n              {shadowPlayQuery?.shadow.author.description}\n            </Typography>\n          </Box>\n        </Box>\n        {following ? (\n          <Button onClick={toggleFollow}>已关注</Button>\n        ) : (\n          <Button onClick={toggleFollow}>关注</Button>\n        )}\n      </Box>\n    </div>\n  );\n}\n","import * as React from \"react\";\nimport {\n  // Theme,\n  // createStyles,\n  // makeStyles,\n  Slider,\n  Box,\n  Typography\n} from \"@material-ui/core\";\nimport { ProgressProps } from \"./player.interface\";\nimport moment from \"moment\";\n\n// const useStyles = makeStyles((theme: Theme) => createStyles({}));\n\nexport default function Progress(props: ProgressProps) {\n  const { duration, currentTime, onChange } = props;\n\n  const formatHandler = (duration: number): string => {\n    // 转换成毫秒\n    const hh = moment.duration(duration, \"ms\").hours() + \"\";\n    const mm = moment.duration(duration, \"ms\").minutes() + \"\";\n    const ss = moment.duration(duration, \"ms\").seconds() + \"\";\n    const format =\n      hh.padStart(2, \"0\") +\n      \":\" +\n      mm.padStart(2, \"0\") +\n      \":\" +\n      ss.padStart(2, \"0\");\n    return format;\n  };\n\n  const durationFormat = formatHandler(duration);\n\n  return (\n    <Box display=\"flex\">\n      <Slider\n        // marks\n        // step={1000}\n        min={0}\n        max={duration}\n        value={currentTime}\n        valueLabelDisplay=\"auto\"\n        valueLabelFormat={value => {\n          const valFormat = formatHandler(value);\n          return valFormat;\n        }}\n        onChange={(e, val: any) => {\n          onChange(val);\n        }}\n        onMouseMove={e => {\n          // const { left, width } = e.currentTarget.getBoundingClientRect();\n          // const x = e.clientX;\n          // const percent = (x - left) / width;\n          // const val = duration * percent;\n        }}\n        disabled={duration === 0}\n      />\n      <Typography>{formatHandler(currentTime)}/</Typography>\n      <Typography>{durationFormat}</Typography>\n    </Box>\n  );\n}\n","import * as React from \"react\";\nimport { IconButton, Popper, Slider } from \"@material-ui/core\";\nimport {\n  VolumeOffRounded,\n  VolumeMuteRounded,\n  VolumeDownRounded,\n  VolumeUpRounded\n} from \"@material-ui/icons\";\nimport { VolumeProps } from \"./player.interface\";\n\nexport default function Volume(props: VolumeProps) {\n  const { volume, muted, onClickMuted, onVolumeChange } = props;\n  const anchorRef = React.useRef(null);\n  const [open, setOpen] = React.useState(false);\n\n  return (\n    <span\n      ref={anchorRef}\n      onMouseEnter={() => setOpen(true)}\n      onMouseLeave={() => setOpen(false)}\n    >\n      <IconButton onClick={onClickMuted}>\n        {muted && <VolumeOffRounded />}\n        {!muted && volume === 0 && <VolumeMuteRounded />}\n        {!muted && volume > 0 && volume <= 0.5 && <VolumeDownRounded />}\n        {!muted && volume > 0.5 && <VolumeUpRounded />}\n      </IconButton>\n      <Popper\n        placement=\"top\"\n        open={open}\n        anchorEl={anchorRef.current}\n        transition\n        disablePortal\n      >\n        <div style={{ height: 80 }}>\n          <Slider\n            step={0.01}\n            min={0}\n            max={1}\n            value={volume}\n            valueLabelDisplay=\"off\"\n            orientation=\"vertical\"\n            onChange={(e, val: any) => {\n              onVolumeChange(val);\n            }}\n          />\n        </div>\n      </Popper>\n    </span>\n  );\n}\n","import { ReactEventHandler } from \"react\";\n\n// 播放速率\nexport enum PlayRate {\n  S075 = 0.75,\n  F125 = 1.25,\n  F150 = 1.5,\n  F200 = 2.0\n}\n\n// 媒体类型\nexport enum MediaType {\n  M3U8 = \"m3u8\",\n  NORMAL = \"normal\"\n}\n\n// Play状态\nexport enum PlayStatus {\n  Loading = 0, // 准备中\n  Ready = 1, // 已准备\n  Waiting = 2, // 加载中\n  Playing = 3, //播放中\n  Pause = 4, // 播放暂停\n  Ended = 5, // 播放完毕\n  Error = 6 // 播放出错\n}\n\nexport interface ProgressProps {\n  duration: number;\n  currentTime: number;\n  onChange: (value: number) => void;\n  cache?: number;\n}\n\nexport interface VolumeProps {\n  volume: number;\n  muted: boolean;\n  onClickMuted: () => void;\n  onVolumeChange: (value: number) => void;\n}\n\nexport interface ToolProps {\n  status: PlayStatus;\n  onPlay: () => void;\n  onPause: () => void;\n}\n\ninterface PlayerAttributes {\n  autoPlay?: boolean;\n  controls?: boolean;\n  controlsList?: string;\n  crossOrigin?: string;\n  loop?: boolean;\n  mediaGroup?: string;\n  muted?: boolean;\n  // playsinline?: boolean;\n  preload?: string;\n  src: string;\n\n  height?: number | string;\n  playsInline?: boolean;\n  poster?: string;\n  width?: number | string;\n  disablePictureInPicture?: boolean;\n}\n\ninterface VideoType {\n  mediaType: MediaType;\n}\n\ninterface PlayerCallback<T> {\n  onError?: ReactEventHandler<T>; // also a Media Event\n  onErrorCapture?: ReactEventHandler<T>; // also a Media Event\n  // Media Events\n  onAbort?: ReactEventHandler<T>;\n  onAbortCapture?: ReactEventHandler<T>;\n  onCanPlay?: ReactEventHandler<T>;\n  onCanPlayCapture?: ReactEventHandler<T>;\n  onCanPlayThrough?: ReactEventHandler<T>;\n  onCanPlayThroughCapture?: ReactEventHandler<T>;\n  onDurationChange?: ReactEventHandler<T>;\n  onDurationChangeCapture?: ReactEventHandler<T>;\n  onEmptied?: ReactEventHandler<T>;\n  onEmptiedCapture?: ReactEventHandler<T>;\n  onEncrypted?: ReactEventHandler<T>;\n  onEncryptedCapture?: ReactEventHandler<T>;\n  onEnded?: ReactEventHandler<T>;\n  onEndedCapture?: ReactEventHandler<T>;\n  onLoadedData?: ReactEventHandler<T>;\n  onLoadedDataCapture?: ReactEventHandler<T>;\n  onLoadedMetadata?: ReactEventHandler<T>;\n  onLoadedMetadataCapture?: ReactEventHandler<T>;\n  onLoadStart?: ReactEventHandler<T>;\n  onLoadStartCapture?: ReactEventHandler<T>;\n  onPause?: ReactEventHandler<T>;\n  onPauseCapture?: ReactEventHandler<T>;\n  onPlay?: ReactEventHandler<T>;\n  onPlayCapture?: ReactEventHandler<T>;\n  onPlaying?: ReactEventHandler<T>;\n  onPlayingCapture?: ReactEventHandler<T>;\n  onProgress?: ReactEventHandler<T>;\n  onProgressCapture?: ReactEventHandler<T>;\n  onRateChange?: ReactEventHandler<T>;\n  onRateChangeCapture?: ReactEventHandler<T>;\n  onSeeked?: ReactEventHandler<T>;\n  onSeekedCapture?: ReactEventHandler<T>;\n  onSeeking?: ReactEventHandler<T>;\n  onSeekingCapture?: ReactEventHandler<T>;\n  onStalled?: ReactEventHandler<T>;\n  onStalledCapture?: ReactEventHandler<T>;\n  onSuspend?: ReactEventHandler<T>;\n  onSuspendCapture?: ReactEventHandler<T>;\n  onTimeUpdate?: ReactEventHandler<T>;\n  onTimeUpdateCapture?: ReactEventHandler<T>;\n  onVolumeChange?: ReactEventHandler<T>;\n  onVolumeChangeCapture?: ReactEventHandler<T>;\n  onWaiting?: ReactEventHandler<T>;\n  onWaitingCapture?: ReactEventHandler<T>;\n}\n\nexport interface PlayerProps\n  extends VideoType,\n    PlayerAttributes,\n    PlayerCallback<any> {}\n","import * as React from \"react\";\nimport { Pause, PlayArrow, SlowMotionVideo } from \"@material-ui/icons\";\nimport { ToolProps, PlayStatus } from \"./player.interface\";\nimport { Box, IconButton } from \"@material-ui/core\";\n\nexport default function Tool(props: ToolProps) {\n  const { status, onPlay, onPause } = props;\n  return (\n    <Box>\n      {(status === PlayStatus.Ready || status === PlayStatus.Pause) && (\n        <IconButton onClick={onPlay}>\n          <PlayArrow />\n        </IconButton>\n      )}\n      {status === PlayStatus.Playing && (\n        <IconButton onClick={onPause}>\n          <Pause />\n        </IconButton>\n      )}\n      {status === PlayStatus.Waiting && (\n        <IconButton>\n          <SlowMotionVideo />\n        </IconButton>\n      )}\n    </Box>\n  );\n}\n","import * as React from \"react\";\nimport {\n  Theme,\n  Typography,\n  ClickAwayListener,\n  Popper\n} from \"@material-ui/core\";\nimport { makeStyles, createStyles } from \"@material-ui/styles\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      width: 300,\n      minHeight: 450,\n      backgroundColor: \"#fff\"\n    }\n  })\n);\n\nexport default function SettingPanel() {\n  const classes = useStyles();\n  const anchorRef = React.useRef(null);\n  // const [anchorEl, setAnchorEl] = React.useState<HTMLElement | null>(null)\n  const [open, setOpen] = React.useState(false);\n\n  return (\n    <div className={classes.root}>\n      <div>\n        <Typography>Speed</Typography>\n        <div\n          ref={anchorRef}\n          style={{ background: \"red\" }}\n          onMouseEnter={() => setOpen(true)}\n          // onClick={() => setOpen(true)}\n          onMouseLeave={() => setOpen(false)}\n        >\n          <Typography>Normal</Typography>\n          <Typography>&gt;</Typography>\n          <Popper\n            placement=\"left-end\"\n            open={open}\n            anchorEl={anchorRef.current}\n            transition\n            disablePortal\n          >\n            {() => (\n              <ClickAwayListener onClickAway={() => setOpen(false)}>\n                <div\n                  style={{ width: 200, height: 40, background: \"blue\" }}\n                  onClick={() => console.log(\"yi\")}\n                >\n                  yi\n                </div>\n              </ClickAwayListener>\n            )}\n          </Popper>\n        </div>\n      </div>\n    </div>\n  );\n}\n","import * as React from \"react\";\nimport { makeStyles, createStyles, Theme } from \"@material-ui/core/styles\";\nimport { IconButton, ClickAwayListener } from \"@material-ui/core\";\nimport { Settings } from \"@material-ui/icons\";\nimport Progress from \"./Progress\";\nimport Volume from \"./Volume\";\nimport Tool from \"./Tool\";\nimport SettingPanel from \"./SettingPanel\";\nimport {\n  PlayerProps,\n  // PlayRate,\n  PlayStatus,\n  MediaType\n} from \"./player.interface\";\nimport Hls from \"hls.js\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      position: \"relative\",\n      minHeight: 700\n    },\n    setting: {},\n    wrap: {\n      position: \"absolute\",\n      bottom: theme.spacing(2),\n      right: theme.spacing(2)\n    },\n    position: {\n      position: \"absolute\",\n      right: 0,\n      bottom: `calc(100% + ${theme.spacing(1)}px)`\n    }\n  })\n);\n\nfunction VideoPlayer(props: PlayerProps) {\n  const {\n    // 业务相关\n    mediaType,\n    src,\n    // 事件相关\n    onDurationChange,\n    onTimeUpdate,\n    onProgress,\n    onVolumeChange,\n    onLoadedMetadata,\n    onRateChange,\n    onWaiting,\n    onPlaying,\n    onPause,\n    onEnded,\n    onError,\n    onCanPlay,\n    ...rest\n  } = props;\n\n  const videoRef = React.useRef<HTMLVideoElement | null>(null);\n  const classes = useStyles();\n  const [openSetting, setOpenSetting] = React.useState(false);\n  const [videoInfo, setVideoInfo] = React.useState({\n    status: PlayStatus.Loading, // 是否可以播放(需初始化)\n    volume: 1, // 音量值(需初始化)\n    muted: false, // 是否静音(需初始化)\n    playbackRate: 1, // 播放速率\n    duration: 0, // 时长信息（ms）\n    currentTime: 0, // (ms)\n    cache: 0 // 已缓存的长度（ms）\n  });\n  const [source] = React.useState(mediaType === MediaType.M3U8 ? \"\" : src);\n\n  React.useEffect(() => {\n    if (mediaType === MediaType.M3U8 && videoRef.current) {\n      const hls = new Hls();\n      hls.loadSource(src);\n      hls.attachMedia(videoRef.current);\n    }\n    // window.player = videoRef.current\n  }, [mediaType, src]);\n\n  // 全屏播放\n  // const fullscreen = () => {\n  //   videoRef.current &&\n  //     videoRef.current.requestFullscreen({\n  //       navigationUI: \"hide\",\n  //     });\n  // };\n\n  // 画中画\n  // const pipscreen = () => {\n  //   // if (videoRef.current && videoRef.current.requestPictureInPicture) {\n  //   // videoRef.current.requestPictureInPicture();\n  //   // }\n  // };\n\n  // 播放\n  const play = function() {\n    videoRef.current && videoRef.current.play();\n  };\n\n  // 暂停\n  const pause = function() {\n    videoRef.current && videoRef.current.pause();\n  };\n\n  // 跳跃\n  const seek = function(num: number, type: \"ms\" | \"s\" = \"ms\") {\n    let result = num;\n    // 转换成秒\n    if (type === \"ms\") {\n      result = result / 1000;\n    }\n    if (videoRef.current) {\n      videoRef.current.currentTime = result;\n    }\n  };\n\n  // 设置音量数值\n  const volume = (num: number, type: \"small\" | \"percent\" = \"small\") => {\n    let result = num;\n    // 转换成小数\n    if (type === \"percent\") {\n      result = result / 100.0;\n    }\n    if (videoRef.current) {\n      videoRef.current.volume = result;\n    }\n  };\n\n  // 设置是否静音\n  const muted = (val: boolean) => {\n    if (videoRef.current) {\n      videoRef.current.muted = val;\n    }\n  };\n\n  // 设置播放速率\n  // const rate = (val: PlayRate) => {\n  //   if (videoRef.current) {\n  //     videoRef.current.playbackRate = val;\n  //   }\n  // };\n\n  // 处理时长信息\n  const durationHandler = (\n    e: React.SyntheticEvent<HTMLVideoElement, Event>\n  ) => {\n    onDurationChange && onDurationChange(e);\n    // 转换成毫秒\n    const duration = e.currentTarget.duration * 1000;\n    setVideoInfo({\n      ...videoInfo,\n      duration\n    });\n  };\n\n  // 处理当前播放点\n  const timeUpdateHandler = (\n    e: React.SyntheticEvent<HTMLVideoElement, Event>\n  ) => {\n    onTimeUpdate && onTimeUpdate(e);\n    // 转换成毫秒\n    const currentTime = e.currentTarget.currentTime * 1000;\n    setVideoInfo({\n      ...videoInfo,\n      currentTime\n    });\n  };\n\n  // 处理缓存点\n  const progressHandler = (\n    e: React.SyntheticEvent<HTMLVideoElement, Event>\n  ) => {\n    onProgress && onProgress(e);\n    const { buffered, duration } = e.currentTarget;\n    if (!buffered || buffered.length === 0) {\n      return;\n    }\n    const end = buffered.end(buffered.length - 1);\n    const cache = end > duration ? duration * 1000 : end * 1000;\n    setVideoInfo({\n      ...videoInfo,\n      cache\n    });\n  };\n\n  // 处理音量\n  const volumeHandler = (e: React.SyntheticEvent<HTMLVideoElement, Event>) => {\n    onVolumeChange && onVolumeChange(e);\n    setVideoInfo({\n      ...videoInfo,\n      volume: +e.currentTarget.volume,\n      muted: !!e.currentTarget.muted\n    });\n  };\n\n  // 速率处理\n  const rateHandler = (e: React.SyntheticEvent<HTMLVideoElement, Event>) => {\n    onRateChange && onRateChange(e);\n    setVideoInfo({\n      ...videoInfo,\n      playbackRate: +e.currentTarget.playbackRate\n    });\n  };\n\n  // 加载处理\n  const waitingHandler = (e: React.SyntheticEvent<HTMLVideoElement, Event>) => {\n    onWaiting && onWaiting(e);\n    setVideoInfo({\n      ...videoInfo,\n      status: PlayStatus.Waiting\n    });\n  };\n\n  // 播放处理\n  const playingHandler = (e: React.SyntheticEvent<HTMLVideoElement, Event>) => {\n    onPlaying && onPlaying(e);\n    setVideoInfo({\n      ...videoInfo,\n      status: PlayStatus.Playing\n    });\n  };\n\n  // 暂停处理\n  const pauseHandler = (e: React.SyntheticEvent<HTMLVideoElement, Event>) => {\n    onPause && onPause(e);\n    setVideoInfo({\n      ...videoInfo,\n      status: PlayStatus.Pause\n    });\n  };\n\n  // 播放完成处理\n  const endedHandler = (e: React.SyntheticEvent<HTMLVideoElement, Event>) => {\n    onEnded && onEnded(e);\n    setVideoInfo({\n      ...videoInfo,\n      status: PlayStatus.Ended\n    });\n  };\n\n  // 播放出错处理\n  const errorHandler = (e: React.SyntheticEvent<HTMLVideoElement, Event>) => {\n    onError && onError(e);\n    setVideoInfo({\n      ...videoInfo,\n      status: PlayStatus.Error\n    });\n  };\n\n  // 能播放处理\n  const canplayHandler = (e: React.SyntheticEvent<HTMLVideoElement, Event>) => {\n    onCanPlay && onCanPlay(e);\n    setVideoInfo({\n      ...videoInfo,\n      status: PlayStatus.Ready\n    });\n  };\n\n  // 处理video需要初始化获取的信息\n  const loadedMetadataHandler = (\n    e: React.SyntheticEvent<HTMLVideoElement, Event>\n  ) => {\n    onLoadedMetadata && onLoadedMetadata(e);\n    const { volume, muted, playbackRate } = e.currentTarget;\n    // console.dir(e.currentTarget)\n    setVideoInfo({\n      ...videoInfo,\n      volume,\n      muted,\n      playbackRate\n    });\n  };\n\n  return (\n    <div className={classes.root}>\n      <video\n        {...rest}\n        src={source}\n        ref={videoRef}\n        // 状态事件\n        onWaiting={waitingHandler}\n        onPlaying={playingHandler}\n        onPause={pauseHandler}\n        onEnded={endedHandler}\n        onError={errorHandler}\n        onCanPlay={canplayHandler}\n        // 其他事件\n        onLoadedMetadata={loadedMetadataHandler}\n        onVolumeChange={volumeHandler}\n        onProgress={progressHandler}\n        onTimeUpdate={timeUpdateHandler}\n        onDurationChange={durationHandler}\n        onRateChange={rateHandler}\n      />\n      <Tool status={videoInfo.status} onPlay={play} onPause={pause} />\n      <Volume\n        volume={videoInfo.volume}\n        muted={videoInfo.muted}\n        onClickMuted={() => muted(!videoInfo.muted)}\n        onVolumeChange={val => volume(val)}\n      />\n      <Progress\n        duration={videoInfo.duration} // 时长信息（ms）\n        currentTime={videoInfo.currentTime} // (ms)\n        onChange={(value: number) => seek(value)}\n      />\n      <ClickAwayListener onClickAway={() => setOpenSetting(false)}>\n        <div className={classes.wrap}>\n          <IconButton\n            className={classes.setting}\n            size=\"small\"\n            onClick={() => setOpenSetting(true)}\n          >\n            <Settings />\n          </IconButton>\n          {openSetting && (\n            <div className={classes.position}>\n              <SettingPanel />\n            </div>\n          )}\n        </div>\n      </ClickAwayListener>\n    </div>\n  );\n}\n\nVideoPlayer.defaultProps = {\n  autoPlay: false,\n  controls: false,\n  controlsList: \"nodownload nofullscreen noremoteplayback\",\n  loop: false,\n  muted: false,\n  playsInline: false,\n  width: 200,\n  height: 100,\n  preload: \"auto\"\n} as Partial<PlayerProps>;\n\nexport default VideoPlayer;\n","import * as React from \"react\";\nimport { makeStyles, createStyles, Theme } from \"@material-ui/core/styles\";\nimport { ShadowPlayer } from \"@/components/app/Player\";\nimport { Box } from \"@material-ui/core\";\nimport {\n  FullScreen,\n  BodyScreen,\n  ContentScreen,\n  AiderScreen\n} from \"@/layouts/PageLayout\";\n// import Image from \"@/components/Image\";\nimport { NextPlay, VideoInfo, Comment } from \"./modules\";\nimport { useParams } from \"react-router\";\nimport { useShadowQuery, ShadowQuery, ShadowMedium } from \"@/schema\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      height: \"100%\"\n    },\n    body: {\n      backgroundColor: theme.palette.background.paper,\n      display: \"flex\",\n      margin: \"0 auto\"\n    },\n    content: {\n      padding: theme.spacing(2, 5),\n      borderRight: `1px solid ${theme.palette.divider}`\n    },\n    aider: {\n      padding: theme.spacing(2, 4),\n      height: \"100%\",\n      overflow: \"auto\"\n    }\n  })\n);\n\nexport const ShadowPlayContext = React.createContext<\n  [ShadowQuery | undefined, ShadowMedium | undefined]\n>([undefined, undefined]);\n\nexport default function ShadowPlay() {\n  const classes = useStyles();\n  const { id } = useParams();\n  const [shadowMedium, setShadowMedium] = React.useState<\n    ShadowMedium | undefined\n  >();\n  let { data } = useShadowQuery({\n    variables: {\n      id: id\n    }\n  });\n\n  React.useEffect(() => {\n    if (data?.shadow.sources.length) {\n      setShadowMedium(data.shadow.sources[0]);\n    }\n  }, [data]);\n\n  return (\n    <Box className={classes.root}>\n      <ShadowPlayContext.Provider value={[data, shadowMedium]}>\n        <FullScreen>\n          <BodyScreen>\n            <ShadowPlayer url={shadowMedium?.url} />\n          </BodyScreen>\n        </FullScreen>\n        <BodyScreen className={classes.body}>\n          <ContentScreen className={classes.content}>\n            <VideoInfo />\n            <NextPlay />\n          </ContentScreen>\n          <AiderScreen sticky className={classes.aider}>\n            <Comment />\n          </AiderScreen>\n        </BodyScreen>\n      </ShadowPlayContext.Provider>\n    </Box>\n  );\n}\n"],"sourceRoot":""}