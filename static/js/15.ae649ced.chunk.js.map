{"version":3,"sources":["components/app/Player/ShadowPlayer.tsx","components/app/Player/withThird.tsx","components/app/Player/index.ts","views/shadows/ShadowPlay/modules/Comment/CommentItem.tsx","views/shadows/ShadowPlay/modules/Comment/AddComment.tsx","views/shadows/ShadowPlay/modules/Comment/index.tsx","views/shadows/ShadowPlay/modules/NextPlay/index.tsx","views/shadows/ShadowPlay/modules/VideoInfo/index.tsx","views/shadows/ShadowPlay/modules/VideoPlayer/Progress.tsx","views/shadows/ShadowPlay/modules/VideoPlayer/Volume.tsx","views/shadows/ShadowPlay/modules/VideoPlayer/player.interface.ts","views/shadows/ShadowPlay/modules/VideoPlayer/Tool.tsx","views/shadows/ShadowPlay/modules/VideoPlayer/SettingPanel.tsx","views/shadows/ShadowPlay/modules/VideoPlayer/index.tsx","views/shadows/ShadowPlay/index.tsx"],"names":["useStyles","makeStyles","theme","createStyles","player","width","height","background","ShadowPlayer","props","classes","url","rest","isM3u8","toString","endsWith","videoRef","React","AspectRatioBox","ratio","ref","className","config","file","forceHLS","attributes","controlsList","disablePictureInPicture","onContextMenu","e","preventDefault","youtube","playerVars","autoplay","playing","modestbranding","rel","showinfo","controls","embedOptions","defaultProps","wrap","position","tool","right","spacing","top","transform","display","flexDirection","justifyContent","maxHeight","overflow","backdropFilter","color","padding","borderRadius","shape","visibility","grouped","border","withThird","Component","youtubeUrl","originUrl","undefined","bridgUrl","setBridgUrl","source","setSource","showThird","ThemeProvider","createMuiTheme","palette","type","ToggleButtonGroup","orientation","value","exclusive","onChange","event","nextValue","ToggleButton","YouTube","avatar","marginRight","main","flex","infoItem","marginLeft","commentText","marginTop","CommentItem","Box","Avatar","src","author","alignItems","Typography","nickname","variant","moment","create_at","format","content","AddComment","setContent","reset","Input","fullWidth","target","placeholder","Button","onClick","onSubmit","disabled","item","borderTop","divider","commentTitle","Comment","ShadowPlayContext","shadowMedium","type_id","id","useReviewsPaginatedQuery","variables","query","last","ReviewMedium","Medium","skip","data","loading","fetchMore","error","useReviewCreatedSubscription","onSubscriptionData","client","newItem","subscriptionData","review_created","writeQuery","ReviewsPaginatedDocument","Object","assign","reviews_paginated","edges","cursor","Date","now","__typename","node","useCreateReviewMutation","applyComment","text","callback","review","length","map","edge","idx","marginY","key","pageInfo","hasNextPage","textAlign","before","endCursor","updateQuery","previousQueryResult","fetchMoreResult","totalCount","SpecialBox","placeholderTitle","NextPlay","useParams","RouterHelper","useRouterHelper","useShadowNextUrgesByShadowQuery","shadow_id","py","gutterBottom","shadow_next_urges_by_shadow","GridList","cellHeight","cols","GridListTile","Media","onClickRoot","gotoShadow","onClickAuthor","gotoProfile","username","Placeholder","title","root","header","marginBottom","toolBox","toolText","description","VideoInfo","shadowPlayQuery","useFollowHelper","owner_uid","shadow","uid","following","toggleFollow","useVoteLazyQuery","fetchPolicy","medium_id","Number","voteQuery","useCreateOrUpdateVoteMutation","update","cache","modify","fields","vote","create_or_update_vote","handleVote","status","report_status","VoteStatus","Default","IconButton","Likd","size","ThumbUpAlt","fontSize","vote_like_count","Dislike","ThumbDownAlt","vote_dislike_count","MoreVert","ml","Progress","duration","currentTime","formatHandler","hh","hours","mm","minutes","ss","seconds","padStart","durationFormat","Slider","min","max","valueLabelDisplay","valueLabelFormat","val","onMouseMove","Volume","volume","muted","onClickMuted","onVolumeChange","anchorRef","open","setOpen","onMouseEnter","onMouseLeave","VolumeOffRounded","VolumeMuteRounded","VolumeDownRounded","VolumeUpRounded","Popper","placement","anchorEl","current","transition","disablePortal","style","step","PlayRate","MediaType","PlayStatus","Tool","onPlay","onPause","Ready","Pause","PlayArrow","Playing","Waiting","SlowMotionVideo","minHeight","backgroundColor","paper","SettingPanel","ClickAwayListener","onClickAway","console","log","setting","bottom","VideoPlayer","mediaType","onDurationChange","onTimeUpdate","onProgress","onLoadedMetadata","onRateChange","onWaiting","onPlaying","onEnded","onError","onCanPlay","openSetting","setOpenSetting","Loading","playbackRate","videoInfo","setVideoInfo","M3U8","hls","Hls","loadSource","attachMedia","Ended","Error","currentTarget","buffered","end","play","pause","num","result","seek","Settings","autoPlay","loop","playsInline","preload","ThirdShadowPlayer","body","margin","borderRight","aider","ShadowPlay","location","useLocation","notice","setNotice","state","setShadowMedium","useShadowQuery","sources","playShadowMedium","find","Helmet","Provider","Collapse","in","Alert","severity","onClose","youtube_url","light","cover","DEFULAT_SHADOW_COVER","sticky"],"mappings":"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","file":"static/js/15.ae649ced.chunk.js","sourcesContent":["import * as React from \"react\";\nimport ReactPlayer, { ReactPlayerProps } from \"react-player\";\nimport { makeStyles, createStyles, Theme } from \"@material-ui/core/styles\";\nimport { AspectRatioBox } from \"@/components/base/AspectRatioBox\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    player: {\n      width: \"100% !important\",\n      height: \"100% !important\",\n      background: \"#000\"\n    }\n  })\n);\n\nexport interface PlayerBaseProps\n  extends Pick<\n    ReactPlayerProps,\n    \"url\" | \"playing\" | \"controls\" | \"muted\" | \"wrapper\" | \"light\"\n  > {}\n\nexport const ShadowPlayer: React.FC<PlayerBaseProps> = props => {\n  const classes = useStyles();\n  const { url, ...rest } = props;\n  const isM3u8 = url?.toString().endsWith(\".m3u8\");\n  const videoRef = React.createRef<ReactPlayer>();\n\n  return (\n    <AspectRatioBox ratio={16 / 9}>\n      <ReactPlayer\n        ref={videoRef}\n        className={classes.player}\n        {...rest}\n        url={url}\n        config={{\n          file: {\n            forceHLS: isM3u8,\n            attributes: {\n              controlsList: \"nodownload noremoteplayback\",\n              disablePictureInPicture: true,\n              onContextMenu: e => e.preventDefault()\n            }\n          },\n          youtube: {\n            playerVars: {\n              autoplay: rest.playing,\n              modestbranding: 1,\n              rel: 0,\n              showinfo: 0,\n              controls: rest.controls\n            },\n            embedOptions: {}\n          }\n        }}\n      />\n    </AspectRatioBox>\n  );\n};\n\nShadowPlayer.defaultProps = {\n  controls: true,\n  playing: true\n};\n\nexport default ShadowPlayer;\n","import * as React from \"react\";\nimport {\n  makeStyles,\n  Theme,\n  createStyles,\n  ThemeProvider,\n  createMuiTheme\n} from \"@material-ui/core\";\nimport { YouTube } from \"@material-ui/icons\";\nimport { ToggleButtonGroup, ToggleButton } from \"@material-ui/lab\";\n// import { Delete } from \"@material-ui/icons\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    wrap: {\n      position: \"relative\",\n      width: \"100%\"\n    },\n    tool: {\n      position: \"absolute\",\n      right: theme.spacing(1),\n      top: \"50%\",\n      transform: \"translateY(-50%)\",\n      display: \"flex\",\n      flexDirection: \"column\",\n      justifyContent: \"space-between\",\n      maxHeight: \"50%\",\n      overflow: \"auto\",\n      background: \"rgba(0, 0, 0, .1)\",\n      backdropFilter: \"blur(8px)\",\n      color: \"#fff\",\n      padding: theme.spacing(1),\n      borderRadius: theme.shape.borderRadius,\n      visibility: \"hidden\",\n      \"$wrap:hover &\": {\n        visibility: \"initial\"\n      }\n    },\n    grouped: {\n      border: \"none\",\n      \"&:not(:first-child)\": {\n        borderRadius: theme.shape.borderRadius\n      },\n      \"&:first-child\": {\n        borderRadius: theme.shape.borderRadius\n      }\n    }\n  })\n);\n\nexport interface WithThirdProps {\n  youtubeUrl?: string | null;\n}\n\nexport function withThird<P>(Component: React.FC<P & WithThirdProps>) {\n  return (props: P & WithThirdProps) => {\n    const classes = useStyles();\n    const { youtubeUrl, ...rest } = props;\n    const originUrl = rest && (rest as any).url ? (rest as any).url : undefined;\n    const [bridgUrl, setBridgUrl] = React.useState<string>(originUrl);\n    const [source, setSource] = React.useState<string>();\n\n    const showThird =\n      youtubeUrl &&\n      rest &&\n      (rest as any).url &&\n      (rest as any).url !== youtubeUrl;\n\n    const handleChange = (\n      event: React.MouseEvent<HTMLElement>,\n      nextValue: string\n    ) => {\n      setSource(nextValue);\n    };\n    React.useEffect(() => {\n      if (source === \"youtube\") {\n        setBridgUrl(youtubeUrl as string);\n      } else {\n        setBridgUrl(originUrl);\n      }\n    }, [source, originUrl, youtubeUrl]);\n\n    return (\n      <div className={classes.wrap}>\n        <Component {...(rest as P)} url={bridgUrl} />\n        {showThird && (\n          <div className={classes.tool}>\n            <ThemeProvider\n              theme={() => {\n                return createMuiTheme({\n                  palette: { type: \"dark\" }\n                });\n              }}\n            >\n              <ToggleButtonGroup\n                classes={{ grouped: classes.grouped }}\n                orientation=\"vertical\"\n                value={source}\n                exclusive\n                onChange={handleChange}\n              >\n                <ToggleButton value=\"youtube\">\n                  <YouTube></YouTube>\n                </ToggleButton>\n              </ToggleButtonGroup>\n            </ThemeProvider>\n          </div>\n        )}\n      </div>\n    );\n  };\n}\nexport default withThird;\n","export * from \"./ShadowPlayer\";\nexport * from \"./withThird\";\n","import * as React from \"react\";\nimport {\n  Box,\n  Typography,\n  Avatar,\n  makeStyles,\n  createStyles,\n  Theme\n} from \"@material-ui/core\";\nimport moment from \"moment\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    avatar: {\n      marginRight: theme.spacing(2)\n    },\n    main: {\n      flex: 1\n    },\n    infoItem: {\n      \"& + &\": {\n        marginLeft: theme.spacing(2)\n      }\n    },\n    commentText: {\n      marginTop: theme.spacing(1)\n    }\n  })\n);\n\nexport interface CommentItemProps {\n  id?: number | string;\n\n  create_at?: Date;\n\n  content: string;\n\n  author?: {\n    avatar?: string;\n    nickname?: string;\n  };\n}\n\nfunction CommentItem(props) {\n  const classes = useStyles();\n\n  return (\n    <Box>\n      <Box display=\"flex\">\n        <Avatar className={classes.avatar} src={props.author.avatar}></Avatar>\n        <div className={classes.main}>\n          <Box\n            display=\"flex\"\n            justifyContent=\"space-between\"\n            alignItems=\"center\"\n          >\n            <Typography>{props.author.nickname}</Typography>\n            <Typography variant=\"caption\">\n              {moment(props.create_at).format(\"YYYY-MM-DD HH:mm\")}\n            </Typography>\n          </Box>\n          <Box display=\"flex\">\n            {/* <Typography variant=\"caption\" className={classes.infoItem}>\n              like 2\n            </Typography>\n            <Typography variant=\"caption\" className={classes.infoItem}>\n              dislike 0\n            </Typography> */}\n          </Box>\n        </div>\n      </Box>\n      <Typography variant=\"body2\" className={classes.commentText}>\n        {props.content}\n      </Typography>\n    </Box>\n  );\n}\n\nexport default CommentItem;\n","import * as React from \"react\";\nimport { Input, Button, Box } from \"@material-ui/core\";\n\nexport interface AddCommentProps {\n  onSubmit?: (text: string, callbacak: () => void) => void;\n}\n\nexport const AddComment = (props: AddCommentProps) => {\n  const [content, setContent] = React.useState<string>(\"\");\n\n  const reset = () => {\n    setContent(\"\");\n  };\n\n  const handleSend = () => {\n    props.onSubmit && props.onSubmit(content, reset);\n  };\n\n  return (\n    <Box display=\"flex\">\n      <Input\n        fullWidth\n        value={content}\n        onChange={e => setContent(e.target.value)}\n        placeholder=\"随便发点~\"\n      />\n      <Button variant=\"outlined\" onClick={handleSend} disabled={!content}>\n        提交\n      </Button>\n    </Box>\n  );\n};\n\nexport default AddComment;\n","import * as React from \"react\";\nimport { Box, Typography, Button } from \"@material-ui/core\";\nimport CommentItem from \"./CommentItem\";\nimport AddComment from \"./AddComment\";\nimport { makeStyles, createStyles, Theme } from \"@material-ui/core/styles\";\nimport {\n  useReviewsPaginatedQuery,\n  ReviewMedium,\n  useCreateReviewMutation,\n  useReviewCreatedSubscription,\n  ReviewsPaginatedDocument\n} from \"@/schema\";\nimport { SpecialBox } from \"@/components/public/SpecialBox\";\nimport { ShadowPlayContext } from \"../..\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    item: {\n      padding: theme.spacing(2, 0),\n      \"& + &\": {\n        borderTop: `1px solid ${theme.palette.divider}`\n      }\n    },\n    commentTitle: {\n      padding: theme.spacing(1, 0)\n    }\n  })\n);\n\nexport default function Comment() {\n  const classes = useStyles();\n  const [, shadowMedium] = React.useContext(ShadowPlayContext);\n  let type_id = shadowMedium ? +shadowMedium?.id : -1;\n  const { data, loading, fetchMore, error } = useReviewsPaginatedQuery({\n    variables: {\n      query: {\n        last: 16\n      },\n      type: ReviewMedium.Medium,\n      type_id\n    },\n    skip: type_id === -1\n  });\n\n  useReviewCreatedSubscription({\n    variables: {\n      type: ReviewMedium.Medium,\n      type_id\n    },\n    skip: type_id === -1,\n    onSubscriptionData({ client, subscriptionData }) {\n      const newItem = subscriptionData.data?.review_created;\n      client.writeQuery({\n        query: ReviewsPaginatedDocument,\n        variables: {\n          query: {\n            last: 16\n          },\n          type: ReviewMedium.Medium,\n          type_id\n        },\n        data: Object.assign({}, data, {\n          reviews_paginated: {\n            ...data?.reviews_paginated,\n            edges: [\n              { cursor: Date.now(), __typename: \"ReviewEdge\", node: newItem },\n              ...data?.reviews_paginated.edges\n            ]\n          }\n        })\n      });\n    }\n  });\n\n  const loadMore = () => {\n    fetchMore({\n      variables: {\n        type: ReviewMedium.Medium,\n        type_id,\n        query: {\n          last: 8,\n          before: data?.reviews_paginated.pageInfo.endCursor\n        }\n      },\n      updateQuery: (previousQueryResult, { fetchMoreResult }) => {\n        if (fetchMoreResult?.reviews_paginated?.edges) {\n          const {\n            edges,\n            pageInfo,\n            totalCount\n          } = fetchMoreResult.reviews_paginated;\n          return {\n            reviews_paginated: {\n              pageInfo,\n              totalCount,\n              edges: [...previousQueryResult.reviews_paginated.edges, ...edges],\n              __typename: previousQueryResult.reviews_paginated.__typename\n            }\n          };\n        }\n        return previousQueryResult;\n      }\n    });\n  };\n\n  const [applyComment] = useCreateReviewMutation();\n\n  const handleSubmit = (text: string, callback: Function) => {\n    applyComment({\n      variables: {\n        review: {\n          content: text,\n          type: ReviewMedium.Medium,\n          type_id\n        }\n      }\n    });\n    callback();\n  };\n\n  return (\n    <Box>\n      <AddComment onSubmit={handleSubmit} />\n      <Typography variant=\"subtitle2\" className={classes.commentTitle}>\n        {/* 评论 */}\n      </Typography>\n      <div>\n        {data?.reviews_paginated?.edges?.length ? (\n          <div>\n            {data?.reviews_paginated?.edges?.map((edge: any, idx) => {\n              return (\n                <Box marginY={1} key={idx}>\n                  <CommentItem {...edge.node} />\n                </Box>\n              );\n            })}\n            {data?.reviews_paginated?.pageInfo?.hasNextPage && (\n              <Box textAlign=\"center\">\n                <Button onClick={loadMore} disabled={loading}>\n                  <Typography color=\"textSecondary\" variant=\"caption\">\n                    {loading ? \"加载中...\" : \"加载更多\"}\n                  </Typography>\n                </Button>\n              </Box>\n            )}\n          </div>\n        ) : (\n          <SpecialBox\n            error={!!error}\n            loading={loading}\n            placeholder\n            placeholderTitle=\"暂无评论\"\n          />\n        )}\n      </div>\n    </Box>\n  );\n}\n","import * as React from \"react\";\nimport { MediaNormal } from \"@/components/app/Media\";\nimport { GridList, GridListTile, Typography, Box } from \"@material-ui/core\";\nimport { useShadowNextUrgesByShadowQuery } from \"@/schema\";\nimport { useParams } from \"react-router-dom\";\nimport Placeholder from \"@/components/base/Placeholder\";\nimport { useRouterHelper } from \"@/hooks\";\n\nexport default function NextPlay() {\n  const { id } = useParams();\n  const RouterHelper = useRouterHelper();\n  const { data, error, loading } = useShadowNextUrgesByShadowQuery({\n    variables: {\n      shadow_id: id\n    }\n  });\n  if (loading) {\n    return <div>loading</div>;\n  }\n  if (error) {\n    return <div>error</div>;\n  }\n  return (\n    <Box py={2}>\n      <Typography variant=\"subtitle1\" gutterBottom>\n        接下来播放\n      </Typography>\n      {data?.shadow_next_urges_by_shadow.length ? (\n        <GridList cellHeight=\"auto\" cols={4}>\n          {data.shadow_next_urges_by_shadow.map((item, idx) => {\n            return (\n              <GridListTile cols={1} key={idx}>\n                <MediaNormal\n                  {...item}\n                  onClickRoot={() => RouterHelper.gotoShadow(item.id)}\n                  onClickAuthor={() =>\n                    RouterHelper.gotoProfile(item.author.username)\n                  }\n                />\n              </GridListTile>\n            );\n          })}\n        </GridList>\n      ) : (\n        <div>\n          <Placeholder title=\"暂无可播放资源\" />\n        </div>\n      )}\n    </Box>\n  );\n}\n","import * as React from \"react\";\nimport { makeStyles, createStyles, Theme } from \"@material-ui/core/styles\";\nimport { Typography, Box, IconButton, Avatar, Button } from \"@material-ui/core\";\nimport { ThumbUpAlt, ThumbDownAlt, MoreVert } from \"@material-ui/icons\";\nimport { ShadowPlayContext } from \"../..\";\nimport moment from \"moment\";\nimport { useFollowHelper } from \"@/hooks\";\nimport {\n  useCreateOrUpdateVoteMutation,\n  VoteStatus,\n  useVoteLazyQuery\n} from \"@/schema\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {},\n    header: {\n      display: \"flex\",\n      justifyContent: \"space-between\",\n      marginBottom: theme.spacing(1)\n    },\n    infoItem: {\n      \"& + &\": {\n        marginLeft: theme.spacing(1)\n      }\n    },\n    toolBox: {\n      display: \"flex\",\n      alignItems: \"center\",\n      marginRight: theme.spacing(2)\n    },\n    toolText: {\n      marginLeft: theme.spacing(0.5)\n    },\n    description: {\n      marginBottom: theme.spacing(1)\n    }\n  })\n);\n\nexport default function VideoInfo() {\n  const classes = useStyles();\n  const [shadowPlayQuery, shadowMedium] = React.useContext(ShadowPlayContext);\n  const { following, toggleFollow } = useFollowHelper({\n    owner_uid: shadowPlayQuery?.shadow.author.uid as string\n  });\n  const [voteQuery, { data }] = useVoteLazyQuery({\n    fetchPolicy: \"network-only\",\n    variables: {\n      medium_id: Number(shadowMedium?.id)\n    }\n    // skip: !shadowMedium?.id,\n  });\n\n  const [create_or_update_vote] = useCreateOrUpdateVoteMutation({\n    update(cache) {\n      // const newStatus = data?.create_or_update_vote.status;\n      // console.log(\"before: \", cache);\n      cache.modify({\n        fields: {\n          vote() {},\n          shadow() {}\n        }\n      });\n    }\n  });\n\n  const handleVote = (status: VoteStatus) => {\n    let report_status = status;\n    if (data?.vote.status === report_status && status !== VoteStatus.Default) {\n      report_status = VoteStatus.Default;\n    }\n    create_or_update_vote({\n      variables: {\n        vote: {\n          medium_id: shadowMedium ? +shadowMedium.id : -1,\n          status: report_status\n        }\n      }\n    });\n  };\n\n  React.useEffect(() => {\n    if (shadowMedium?.id) {\n      voteQuery();\n    }\n  }, [shadowMedium, voteQuery]);\n\n  return (\n    <div>\n      <Box className={classes.header}>\n        <div>\n          <Typography variant=\"subtitle1\">\n            {shadowPlayQuery?.shadow.title}\n          </Typography>\n          <Box display=\"flex\">\n            {/* <Typography variant=\"caption\" className={classes.infoItem}>\n              观看: TODO\n            </Typography> */}\n            <Typography variant=\"caption\" className={classes.infoItem}>\n              发布时间:{\" \"}\n              {moment(shadowPlayQuery?.shadow.create_at).format(\n                \"YYYY-MM-DD HH:mm\"\n              )}\n            </Typography>\n          </Box>\n        </div>\n        <Box display=\"flex\" alignItems=\"center\">\n          <Box className={classes.toolBox}>\n            <IconButton\n              color={\n                data?.vote.status === VoteStatus.Likd ? \"primary\" : \"default\"\n              }\n              size=\"small\"\n              onClick={() => handleVote(VoteStatus.Likd)}\n            >\n              <ThumbUpAlt fontSize=\"small\" />\n            </IconButton>\n            <Typography className={classes.toolText}>\n              {shadowMedium?.vote_like_count}\n            </Typography>\n          </Box>\n          <Box className={classes.toolBox}>\n            <IconButton\n              color={\n                data?.vote.status === VoteStatus.Dislike ? \"primary\" : \"default\"\n              }\n              size=\"small\"\n              onClick={() => handleVote(VoteStatus.Dislike)}\n            >\n              <ThumbDownAlt fontSize=\"small\" />\n            </IconButton>\n            <Typography className={classes.toolText}>\n              {shadowMedium?.vote_dislike_count}\n            </Typography>\n          </Box>\n          <IconButton size=\"small\">\n            <MoreVert fontSize=\"small\" />\n          </IconButton>\n        </Box>\n      </Box>\n      <Typography className={classes.description} variant=\"body2\">\n        {shadowMedium?.description || shadowPlayQuery?.shadow.description}\n      </Typography>\n\n      <Box display=\"flex\" justifyContent=\"space-between\" alignItems=\"center\">\n        <Box display=\"flex\" alignItems=\"center\">\n          <Avatar src={shadowPlayQuery?.shadow.author.avatar}></Avatar>\n          <Box ml={1}>\n            <Typography variant=\"subtitle2\">\n              {shadowPlayQuery?.shadow.author.nickname}\n            </Typography>\n            <Typography variant=\"caption\">\n              {shadowPlayQuery?.shadow.author.description}\n            </Typography>\n          </Box>\n        </Box>\n        {following ? (\n          <Button onClick={toggleFollow}>已关注</Button>\n        ) : (\n          <Button onClick={toggleFollow}>关注</Button>\n        )}\n      </Box>\n    </div>\n  );\n}\n","import * as React from \"react\";\nimport {\n  // Theme,\n  // createStyles,\n  // makeStyles,\n  Slider,\n  Box,\n  Typography\n} from \"@material-ui/core\";\nimport { ProgressProps } from \"./player.interface\";\nimport moment from \"moment\";\n\n// const useStyles = makeStyles((theme: Theme) => createStyles({}));\n\nexport default function Progress(props: ProgressProps) {\n  const { duration, currentTime, onChange } = props;\n\n  const formatHandler = (duration: number): string => {\n    // 转换成毫秒\n    const hh = moment.duration(duration, \"ms\").hours() + \"\";\n    const mm = moment.duration(duration, \"ms\").minutes() + \"\";\n    const ss = moment.duration(duration, \"ms\").seconds() + \"\";\n    const format =\n      hh.padStart(2, \"0\") +\n      \":\" +\n      mm.padStart(2, \"0\") +\n      \":\" +\n      ss.padStart(2, \"0\");\n    return format;\n  };\n\n  const durationFormat = formatHandler(duration);\n\n  return (\n    <Box display=\"flex\">\n      <Slider\n        // marks\n        // step={1000}\n        min={0}\n        max={duration}\n        value={currentTime}\n        valueLabelDisplay=\"auto\"\n        valueLabelFormat={value => {\n          const valFormat = formatHandler(value);\n          return valFormat;\n        }}\n        onChange={(e, val: any) => {\n          onChange(val);\n        }}\n        onMouseMove={e => {\n          // const { left, width } = e.currentTarget.getBoundingClientRect();\n          // const x = e.clientX;\n          // const percent = (x - left) / width;\n          // const val = duration * percent;\n        }}\n        disabled={duration === 0}\n      />\n      <Typography>{formatHandler(currentTime)}/</Typography>\n      <Typography>{durationFormat}</Typography>\n    </Box>\n  );\n}\n","import * as React from \"react\";\nimport { IconButton, Popper, Slider } from \"@material-ui/core\";\nimport {\n  VolumeOffRounded,\n  VolumeMuteRounded,\n  VolumeDownRounded,\n  VolumeUpRounded\n} from \"@material-ui/icons\";\nimport { VolumeProps } from \"./player.interface\";\n\nexport default function Volume(props: VolumeProps) {\n  const { volume, muted, onClickMuted, onVolumeChange } = props;\n  const anchorRef = React.useRef(null);\n  const [open, setOpen] = React.useState(false);\n\n  return (\n    <span\n      ref={anchorRef}\n      onMouseEnter={() => setOpen(true)}\n      onMouseLeave={() => setOpen(false)}\n    >\n      <IconButton onClick={onClickMuted}>\n        {muted && <VolumeOffRounded />}\n        {!muted && volume === 0 && <VolumeMuteRounded />}\n        {!muted && volume > 0 && volume <= 0.5 && <VolumeDownRounded />}\n        {!muted && volume > 0.5 && <VolumeUpRounded />}\n      </IconButton>\n      <Popper\n        placement=\"top\"\n        open={open}\n        anchorEl={anchorRef.current}\n        transition\n        disablePortal\n      >\n        <div style={{ height: 80 }}>\n          <Slider\n            step={0.01}\n            min={0}\n            max={1}\n            value={volume}\n            valueLabelDisplay=\"off\"\n            orientation=\"vertical\"\n            onChange={(e, val: any) => {\n              onVolumeChange(val);\n            }}\n          />\n        </div>\n      </Popper>\n    </span>\n  );\n}\n","import { ReactEventHandler } from \"react\";\n\n// 播放速率\nexport enum PlayRate {\n  S075 = 0.75,\n  F125 = 1.25,\n  F150 = 1.5,\n  F200 = 2.0\n}\n\n// 媒体类型\nexport enum MediaType {\n  M3U8 = \"m3u8\",\n  NORMAL = \"normal\"\n}\n\n// Play状态\nexport enum PlayStatus {\n  Loading = 0, // 准备中\n  Ready = 1, // 已准备\n  Waiting = 2, // 加载中\n  Playing = 3, //播放中\n  Pause = 4, // 播放暂停\n  Ended = 5, // 播放完毕\n  Error = 6 // 播放出错\n}\n\nexport interface ProgressProps {\n  duration: number;\n  currentTime: number;\n  onChange: (value: number) => void;\n  cache?: number;\n}\n\nexport interface VolumeProps {\n  volume: number;\n  muted: boolean;\n  onClickMuted: () => void;\n  onVolumeChange: (value: number) => void;\n}\n\nexport interface ToolProps {\n  status: PlayStatus;\n  onPlay: () => void;\n  onPause: () => void;\n}\n\ninterface PlayerAttributes {\n  autoPlay?: boolean;\n  controls?: boolean;\n  controlsList?: string;\n  crossOrigin?: string;\n  loop?: boolean;\n  mediaGroup?: string;\n  muted?: boolean;\n  // playsinline?: boolean;\n  preload?: string;\n  src: string;\n\n  height?: number | string;\n  playsInline?: boolean;\n  poster?: string;\n  width?: number | string;\n  disablePictureInPicture?: boolean;\n}\n\ninterface VideoType {\n  mediaType: MediaType;\n}\n\ninterface PlayerCallback<T> {\n  onError?: ReactEventHandler<T>; // also a Media Event\n  onErrorCapture?: ReactEventHandler<T>; // also a Media Event\n  // Media Events\n  onAbort?: ReactEventHandler<T>;\n  onAbortCapture?: ReactEventHandler<T>;\n  onCanPlay?: ReactEventHandler<T>;\n  onCanPlayCapture?: ReactEventHandler<T>;\n  onCanPlayThrough?: ReactEventHandler<T>;\n  onCanPlayThroughCapture?: ReactEventHandler<T>;\n  onDurationChange?: ReactEventHandler<T>;\n  onDurationChangeCapture?: ReactEventHandler<T>;\n  onEmptied?: ReactEventHandler<T>;\n  onEmptiedCapture?: ReactEventHandler<T>;\n  onEncrypted?: ReactEventHandler<T>;\n  onEncryptedCapture?: ReactEventHandler<T>;\n  onEnded?: ReactEventHandler<T>;\n  onEndedCapture?: ReactEventHandler<T>;\n  onLoadedData?: ReactEventHandler<T>;\n  onLoadedDataCapture?: ReactEventHandler<T>;\n  onLoadedMetadata?: ReactEventHandler<T>;\n  onLoadedMetadataCapture?: ReactEventHandler<T>;\n  onLoadStart?: ReactEventHandler<T>;\n  onLoadStartCapture?: ReactEventHandler<T>;\n  onPause?: ReactEventHandler<T>;\n  onPauseCapture?: ReactEventHandler<T>;\n  onPlay?: ReactEventHandler<T>;\n  onPlayCapture?: ReactEventHandler<T>;\n  onPlaying?: ReactEventHandler<T>;\n  onPlayingCapture?: ReactEventHandler<T>;\n  onProgress?: ReactEventHandler<T>;\n  onProgressCapture?: ReactEventHandler<T>;\n  onRateChange?: ReactEventHandler<T>;\n  onRateChangeCapture?: ReactEventHandler<T>;\n  onSeeked?: ReactEventHandler<T>;\n  onSeekedCapture?: ReactEventHandler<T>;\n  onSeeking?: ReactEventHandler<T>;\n  onSeekingCapture?: ReactEventHandler<T>;\n  onStalled?: ReactEventHandler<T>;\n  onStalledCapture?: ReactEventHandler<T>;\n  onSuspend?: ReactEventHandler<T>;\n  onSuspendCapture?: ReactEventHandler<T>;\n  onTimeUpdate?: ReactEventHandler<T>;\n  onTimeUpdateCapture?: ReactEventHandler<T>;\n  onVolumeChange?: ReactEventHandler<T>;\n  onVolumeChangeCapture?: ReactEventHandler<T>;\n  onWaiting?: ReactEventHandler<T>;\n  onWaitingCapture?: ReactEventHandler<T>;\n}\n\nexport interface PlayerProps\n  extends VideoType,\n    PlayerAttributes,\n    PlayerCallback<any> {}\n","import * as React from \"react\";\nimport { Pause, PlayArrow, SlowMotionVideo } from \"@material-ui/icons\";\nimport { ToolProps, PlayStatus } from \"./player.interface\";\nimport { Box, IconButton } from \"@material-ui/core\";\n\nexport default function Tool(props: ToolProps) {\n  const { status, onPlay, onPause } = props;\n  return (\n    <Box>\n      {(status === PlayStatus.Ready || status === PlayStatus.Pause) && (\n        <IconButton onClick={onPlay}>\n          <PlayArrow />\n        </IconButton>\n      )}\n      {status === PlayStatus.Playing && (\n        <IconButton onClick={onPause}>\n          <Pause />\n        </IconButton>\n      )}\n      {status === PlayStatus.Waiting && (\n        <IconButton>\n          <SlowMotionVideo />\n        </IconButton>\n      )}\n    </Box>\n  );\n}\n","import * as React from \"react\";\nimport {\n  Theme,\n  Typography,\n  ClickAwayListener,\n  Popper\n} from \"@material-ui/core\";\nimport { makeStyles, createStyles } from \"@material-ui/styles\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      width: 300,\n      minHeight: 450,\n      backgroundColor: theme.palette.background.paper\n    }\n  })\n);\n\nexport default function SettingPanel() {\n  const classes = useStyles();\n  const anchorRef = React.useRef(null);\n  // const [anchorEl, setAnchorEl] = React.useState<HTMLElement | null>(null)\n  const [open, setOpen] = React.useState(false);\n\n  return (\n    <div className={classes.root}>\n      <div>\n        <Typography>Speed</Typography>\n        <div\n          ref={anchorRef}\n          style={{ background: \"red\" }}\n          onMouseEnter={() => setOpen(true)}\n          // onClick={() => setOpen(true)}\n          onMouseLeave={() => setOpen(false)}\n        >\n          <Typography>Normal</Typography>\n          <Typography>&gt;</Typography>\n          <Popper\n            placement=\"left-end\"\n            open={open}\n            anchorEl={anchorRef.current}\n            transition\n            disablePortal\n          >\n            {() => (\n              <ClickAwayListener onClickAway={() => setOpen(false)}>\n                <div\n                  style={{ width: 200, height: 40, background: \"blue\" }}\n                  onClick={() => console.log(\"yi\")}\n                >\n                  yi\n                </div>\n              </ClickAwayListener>\n            )}\n          </Popper>\n        </div>\n      </div>\n    </div>\n  );\n}\n","import * as React from \"react\";\nimport { makeStyles, createStyles, Theme } from \"@material-ui/core/styles\";\nimport { IconButton, ClickAwayListener } from \"@material-ui/core\";\nimport { Settings } from \"@material-ui/icons\";\nimport Progress from \"./Progress\";\nimport Volume from \"./Volume\";\nimport Tool from \"./Tool\";\nimport SettingPanel from \"./SettingPanel\";\nimport {\n  PlayerProps,\n  // PlayRate,\n  PlayStatus,\n  MediaType\n} from \"./player.interface\";\nimport Hls from \"hls.js\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      position: \"relative\",\n      minHeight: 700\n    },\n    setting: {},\n    wrap: {\n      position: \"absolute\",\n      bottom: theme.spacing(2),\n      right: theme.spacing(2)\n    },\n    position: {\n      position: \"absolute\",\n      right: 0,\n      bottom: `calc(100% + ${theme.spacing(1)}px)`\n    }\n  })\n);\n\nfunction VideoPlayer(props: PlayerProps) {\n  const {\n    // 业务相关\n    mediaType,\n    src,\n    // 事件相关\n    onDurationChange,\n    onTimeUpdate,\n    onProgress,\n    onVolumeChange,\n    onLoadedMetadata,\n    onRateChange,\n    onWaiting,\n    onPlaying,\n    onPause,\n    onEnded,\n    onError,\n    onCanPlay,\n    ...rest\n  } = props;\n\n  const videoRef = React.useRef<HTMLVideoElement | null>(null);\n  const classes = useStyles();\n  const [openSetting, setOpenSetting] = React.useState(false);\n  const [videoInfo, setVideoInfo] = React.useState({\n    status: PlayStatus.Loading, // 是否可以播放(需初始化)\n    volume: 1, // 音量值(需初始化)\n    muted: false, // 是否静音(需初始化)\n    playbackRate: 1, // 播放速率\n    duration: 0, // 时长信息（ms）\n    currentTime: 0, // (ms)\n    cache: 0 // 已缓存的长度（ms）\n  });\n  const [source] = React.useState(mediaType === MediaType.M3U8 ? \"\" : src);\n\n  React.useEffect(() => {\n    if (mediaType === MediaType.M3U8 && videoRef.current) {\n      const hls = new Hls();\n      hls.loadSource(src);\n      hls.attachMedia(videoRef.current);\n    }\n    // window.player = videoRef.current\n  }, [mediaType, src]);\n\n  // 全屏播放\n  // const fullscreen = () => {\n  //   videoRef.current &&\n  //     videoRef.current.requestFullscreen({\n  //       navigationUI: \"hide\",\n  //     });\n  // };\n\n  // 画中画\n  // const pipscreen = () => {\n  //   // if (videoRef.current && videoRef.current.requestPictureInPicture) {\n  //   // videoRef.current.requestPictureInPicture();\n  //   // }\n  // };\n\n  // 播放\n  const play = function() {\n    videoRef.current && videoRef.current.play();\n  };\n\n  // 暂停\n  const pause = function() {\n    videoRef.current && videoRef.current.pause();\n  };\n\n  // 跳跃\n  const seek = function(num: number, type: \"ms\" | \"s\" = \"ms\") {\n    let result = num;\n    // 转换成秒\n    if (type === \"ms\") {\n      result = result / 1000;\n    }\n    if (videoRef.current) {\n      videoRef.current.currentTime = result;\n    }\n  };\n\n  // 设置音量数值\n  const volume = (num: number, type: \"small\" | \"percent\" = \"small\") => {\n    let result = num;\n    // 转换成小数\n    if (type === \"percent\") {\n      result = result / 100.0;\n    }\n    if (videoRef.current) {\n      videoRef.current.volume = result;\n    }\n  };\n\n  // 设置是否静音\n  const muted = (val: boolean) => {\n    if (videoRef.current) {\n      videoRef.current.muted = val;\n    }\n  };\n\n  // 设置播放速率\n  // const rate = (val: PlayRate) => {\n  //   if (videoRef.current) {\n  //     videoRef.current.playbackRate = val;\n  //   }\n  // };\n\n  // 处理时长信息\n  const durationHandler = (\n    e: React.SyntheticEvent<HTMLVideoElement, Event>\n  ) => {\n    onDurationChange && onDurationChange(e);\n    // 转换成毫秒\n    const duration = e.currentTarget.duration * 1000;\n    setVideoInfo({\n      ...videoInfo,\n      duration\n    });\n  };\n\n  // 处理当前播放点\n  const timeUpdateHandler = (\n    e: React.SyntheticEvent<HTMLVideoElement, Event>\n  ) => {\n    onTimeUpdate && onTimeUpdate(e);\n    // 转换成毫秒\n    const currentTime = e.currentTarget.currentTime * 1000;\n    setVideoInfo({\n      ...videoInfo,\n      currentTime\n    });\n  };\n\n  // 处理缓存点\n  const progressHandler = (\n    e: React.SyntheticEvent<HTMLVideoElement, Event>\n  ) => {\n    onProgress && onProgress(e);\n    const { buffered, duration } = e.currentTarget;\n    if (!buffered || buffered.length === 0) {\n      return;\n    }\n    const end = buffered.end(buffered.length - 1);\n    const cache = end > duration ? duration * 1000 : end * 1000;\n    setVideoInfo({\n      ...videoInfo,\n      cache\n    });\n  };\n\n  // 处理音量\n  const volumeHandler = (e: React.SyntheticEvent<HTMLVideoElement, Event>) => {\n    onVolumeChange && onVolumeChange(e);\n    setVideoInfo({\n      ...videoInfo,\n      volume: +e.currentTarget.volume,\n      muted: !!e.currentTarget.muted\n    });\n  };\n\n  // 速率处理\n  const rateHandler = (e: React.SyntheticEvent<HTMLVideoElement, Event>) => {\n    onRateChange && onRateChange(e);\n    setVideoInfo({\n      ...videoInfo,\n      playbackRate: +e.currentTarget.playbackRate\n    });\n  };\n\n  // 加载处理\n  const waitingHandler = (e: React.SyntheticEvent<HTMLVideoElement, Event>) => {\n    onWaiting && onWaiting(e);\n    setVideoInfo({\n      ...videoInfo,\n      status: PlayStatus.Waiting\n    });\n  };\n\n  // 播放处理\n  const playingHandler = (e: React.SyntheticEvent<HTMLVideoElement, Event>) => {\n    onPlaying && onPlaying(e);\n    setVideoInfo({\n      ...videoInfo,\n      status: PlayStatus.Playing\n    });\n  };\n\n  // 暂停处理\n  const pauseHandler = (e: React.SyntheticEvent<HTMLVideoElement, Event>) => {\n    onPause && onPause(e);\n    setVideoInfo({\n      ...videoInfo,\n      status: PlayStatus.Pause\n    });\n  };\n\n  // 播放完成处理\n  const endedHandler = (e: React.SyntheticEvent<HTMLVideoElement, Event>) => {\n    onEnded && onEnded(e);\n    setVideoInfo({\n      ...videoInfo,\n      status: PlayStatus.Ended\n    });\n  };\n\n  // 播放出错处理\n  const errorHandler = (e: React.SyntheticEvent<HTMLVideoElement, Event>) => {\n    onError && onError(e);\n    setVideoInfo({\n      ...videoInfo,\n      status: PlayStatus.Error\n    });\n  };\n\n  // 能播放处理\n  const canplayHandler = (e: React.SyntheticEvent<HTMLVideoElement, Event>) => {\n    onCanPlay && onCanPlay(e);\n    setVideoInfo({\n      ...videoInfo,\n      status: PlayStatus.Ready\n    });\n  };\n\n  // 处理video需要初始化获取的信息\n  const loadedMetadataHandler = (\n    e: React.SyntheticEvent<HTMLVideoElement, Event>\n  ) => {\n    onLoadedMetadata && onLoadedMetadata(e);\n    const { volume, muted, playbackRate } = e.currentTarget;\n    // console.dir(e.currentTarget)\n    setVideoInfo({\n      ...videoInfo,\n      volume,\n      muted,\n      playbackRate\n    });\n  };\n\n  return (\n    <div className={classes.root}>\n      <video\n        {...rest}\n        src={source}\n        ref={videoRef}\n        // 状态事件\n        onWaiting={waitingHandler}\n        onPlaying={playingHandler}\n        onPause={pauseHandler}\n        onEnded={endedHandler}\n        onError={errorHandler}\n        onCanPlay={canplayHandler}\n        // 其他事件\n        onLoadedMetadata={loadedMetadataHandler}\n        onVolumeChange={volumeHandler}\n        onProgress={progressHandler}\n        onTimeUpdate={timeUpdateHandler}\n        onDurationChange={durationHandler}\n        onRateChange={rateHandler}\n      />\n      <Tool status={videoInfo.status} onPlay={play} onPause={pause} />\n      <Volume\n        volume={videoInfo.volume}\n        muted={videoInfo.muted}\n        onClickMuted={() => muted(!videoInfo.muted)}\n        onVolumeChange={val => volume(val)}\n      />\n      <Progress\n        duration={videoInfo.duration} // 时长信息（ms）\n        currentTime={videoInfo.currentTime} // (ms)\n        onChange={(value: number) => seek(value)}\n      />\n      <ClickAwayListener onClickAway={() => setOpenSetting(false)}>\n        <div className={classes.wrap}>\n          <IconButton\n            className={classes.setting}\n            size=\"small\"\n            onClick={() => setOpenSetting(true)}\n          >\n            <Settings />\n          </IconButton>\n          {openSetting && (\n            <div className={classes.position}>\n              <SettingPanel />\n            </div>\n          )}\n        </div>\n      </ClickAwayListener>\n    </div>\n  );\n}\n\nVideoPlayer.defaultProps = {\n  autoPlay: false,\n  controls: false,\n  controlsList: \"nodownload nofullscreen noremoteplayback\",\n  loop: false,\n  muted: false,\n  playsInline: false,\n  width: 200,\n  height: 100,\n  preload: \"auto\"\n} as Partial<PlayerProps>;\n\nexport default VideoPlayer;\n","import * as React from \"react\";\nimport { makeStyles, createStyles, Theme } from \"@material-ui/core/styles\";\nimport { ShadowPlayer, withThird } from \"@/components/app/Player\";\nimport { Box, Collapse } from \"@material-ui/core\";\nimport {\n  FullScreen,\n  BodyScreen,\n  ContentScreen,\n  AiderScreen\n} from \"@/layouts/PageLayout\";\n// import Image from \"@/components/Image\";\nimport { NextPlay, VideoInfo, Comment } from \"./modules\";\nimport { useParams, useLocation } from \"react-router\";\nimport { useShadowQuery, ShadowQuery, ShadowMedium } from \"@/schema\";\nimport { DEFULAT_SHADOW_COVER } from \"@/common/constants/default.constant\";\nimport { Alert } from \"@material-ui/lab\";\nimport { Helmet } from \"react-helmet\";\n\nconst ThirdShadowPlayer = withThird(ShadowPlayer);\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      height: \"100%\"\n    },\n    body: {\n      backgroundColor: theme.palette.background.paper,\n      display: \"flex\",\n      margin: \"0 auto\"\n    },\n    content: {\n      padding: theme.spacing(2, 5),\n      borderRight: `1px solid ${theme.palette.divider}`\n    },\n    aider: {\n      padding: theme.spacing(2, 4),\n      height: \"100%\",\n      overflow: \"auto\"\n    }\n  })\n);\n\nexport const ShadowPlayContext = React.createContext<\n  [ShadowQuery | undefined, ShadowMedium | undefined]\n>([undefined, undefined]);\n\nexport default function ShadowPlay() {\n  const classes = useStyles();\n  const { id } = useParams();\n  const location = useLocation();\n\n  const [notice, setNotice] = React.useState(true);\n\n  const { medium_id } = (location.state as any) || {\n    medium_id: undefined\n  };\n  const [shadowMedium, setShadowMedium] = React.useState<\n    ShadowMedium | undefined\n  >();\n  let { data } = useShadowQuery({\n    variables: {\n      id: id\n    }\n  });\n\n  React.useEffect(() => {\n    if (data?.shadow?.sources?.length) {\n      const playShadowMedium = data.shadow.sources.find(\n        item => +item.id === +medium_id\n      );\n      setShadowMedium(playShadowMedium || data.shadow.sources[0]);\n    }\n  }, [data, medium_id]);\n\n  return (\n    <Box className={classes.root}>\n      <Helmet>\n        <title>{data?.shadow.title}</title>\n      </Helmet>\n      <ShadowPlayContext.Provider value={[data, shadowMedium]}>\n        <FullScreen>\n          <BodyScreen>\n            <Collapse in={notice} style={{ width: \"100%\" }}>\n              <Alert severity=\"warning\" onClose={() => setNotice(false)}>\n                {/* <AlertTitle>重要消息</AlertTitle> */}\n                服务器配置低，请耐心等待加载...\n              </Alert>\n            </Collapse>\n          </BodyScreen>\n          <BodyScreen>\n            <ThirdShadowPlayer\n              controls\n              playing\n              youtubeUrl={shadowMedium?.youtube_url}\n              url={shadowMedium?.url}\n              light={\n                shadowMedium?.cover ? shadowMedium?.cover : DEFULAT_SHADOW_COVER\n              }\n            />\n          </BodyScreen>\n        </FullScreen>\n        <BodyScreen className={classes.body}>\n          <ContentScreen className={classes.content}>\n            <VideoInfo />\n            <NextPlay />\n          </ContentScreen>\n          <AiderScreen sticky className={classes.aider}>\n            <Comment />\n          </AiderScreen>\n        </BodyScreen>\n      </ShadowPlayContext.Provider>\n    </Box>\n  );\n}\n"],"sourceRoot":""}