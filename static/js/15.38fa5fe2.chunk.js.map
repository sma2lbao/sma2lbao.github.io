{"version":3,"sources":["../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/iterableToArray.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js","views/public/Search/index.tsx"],"names":["_toConsumableArray","arr","Array","isArray","arrayLikeToArray","iter","Symbol","iterator","Object","from","unsupportedIterableToArray","TypeError","useStyles","makeStyles","theme","createStyles","content","margin","padding","spacing","background","palette","paper","aider","backgroundColor","width","borderLeft","borderColor","divider","gridRoot","display","gridTemplateColumns","gridGap","gridAutoFlow","gridCard","gridRow","gridColumn","footer","textAlign","scollButton","position","right","bottom","Search","word","useParams","RouterHelper","useRouterHelper","classes","useSearchShadowsPaginatedQuery","variables","query","last","data","loading","error","fetchMore","className","search_shadows_paginated","edges","length","map","edge","key","cursor","node","onClickRoot","gotoShadow","id","onClickAuthor","gotoProfile","author","username","placeholder","placeholderTitle","loadingNode","cellHeight","cols","_","index","pageInfo","hasNextPage","onClick","before","endCursor","updateQuery","previousQueryResult","fetchMoreResult","totalCount","__typename","disabled","color","variant","sticky","title"],"mappings":"yHAIe,SAASA,EAAmBC,GACzC,OCJa,SAA4BA,GACzC,GAAIC,MAAMC,QAAQF,GAAM,OAAO,OAAAG,EAAA,GAAiBH,GDGzC,CAAkBA,IELZ,SAA0BI,GACvC,GAAsB,qBAAXC,QAA0BA,OAAOC,YAAYC,OAAOH,GAAO,OAAOH,MAAMO,KAAKJ,GFIvD,CAAgBJ,IAAQ,OAAAS,EAAA,GAA2BT,IGLvE,WACb,MAAM,IAAIU,UAAU,wIHIwE,GAL9F,mC,0NI2BMC,EAAYC,aAAW,SAACC,GAAD,OAC3BC,YAAa,CACXC,QAAS,CACPC,OAAQ,SACRC,QAASJ,EAAMK,QAAQ,GACvBC,WAAYN,EAAMO,QAAQD,WAAWE,OAEvCC,MAAO,CACLC,gBAAiBV,EAAMO,QAAQD,WAAWE,MAC1CG,MAAO,OACPP,QAASJ,EAAMK,QAAQ,EAAG,GAC1BO,WAAY,YACZC,YAAab,EAAMO,QAAQO,SAE7BC,SAAU,CACRC,QAAS,OACTC,oBAAqB,iBACrBC,QAASlB,EAAMK,QAAQ,EAAG,GAC1Bc,aAAc,aAEhBC,SAAU,CACRC,QAAS,SACTC,WAAY,UAEdC,OAAQ,CACNnB,QAASJ,EAAMK,QAAQ,GACvBmB,UAAW,UAEbC,YAAa,CACXC,SAAU,QACVC,MAAO3B,EAAMK,QAAQ,GACrBuB,OAAQ5B,EAAMK,QAAQ,SAKfwB,EAAmB,WAAO,IAAD,YAC5BC,EAASC,cAATD,KACFE,EAAeC,cACfC,EAAUpC,IAHoB,EAIQqC,YAA+B,CACzEC,UAAW,CACTC,MAAO,CACLC,KAAM,IAERR,KAAMA,KALFS,EAJ4B,EAI5BA,KAAMC,EAJsB,EAItBA,QAASC,EAJa,EAIbA,MAAOC,EAJM,EAINA,UA+C9B,OACE,gBAAC,IAAD,KACE,gBAAC,IAAD,KACE,gBAAC,IAAD,CAAeC,UAAWT,EAAQhC,UAC3B,OAAJqC,QAAI,IAAJA,GAAA,UAAAA,EAAMK,gCAAN,mBAAgCC,aAAhC,eAAuCC,QACtC,gBAAC,IAAD,CAAKH,UAAWT,EAAQnB,UAAxB,OACGwB,QADH,IACGA,GADH,UACGA,EAAMK,gCADT,iBACG,EAAgCC,aADnC,aACG,EAAuCE,KAAI,SAACC,GAC3C,OACE,uBAAKC,IAAKD,EAAKE,OAAQP,UAAWT,EAAQd,UACxC,gBAAC,IAAD,iBACM4B,EAAKG,KADX,CAEEC,YAAa,kBAAMpB,EAAaqB,WAAWL,EAAKG,KAAKG,KACrDC,cAAe,kBACbvB,EAAawB,YAAYR,EAAKG,KAAKM,OAAOC,mBAQtD,gBAAC,IAAD,CACElB,QAASA,EACTC,QAASA,EACTkB,aAAW,EACXC,iBAAiB,uCACjBC,YACE,gBAAC,IAAD,CAAUC,WAAW,OAAOC,KAAM,GAC/B,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAAGhB,KAAI,SAACiB,EAAGC,GAChC,OACE,gBAAC,IAAD,CAAchB,IAAKgB,EAAOF,KAAM,GAC9B,gBAAC,IAAD,CAAavB,SAAO,YAS7B,OAAJD,QAAI,IAAJA,GAAA,UAAAA,EAAMK,gCAAN,mBAAgCsB,gBAAhC,eAA0CC,cACzC,gBAAC,IAAD,CAAKxB,UAAWT,EAAQX,QACtB,gBAAC,IAAD,CAAQ6C,QAhFH,WAAO,IAAD,IACrB1B,EAAU,CACRN,UAAW,CACTC,MAAO,CACLC,KAAM,EACN+B,OAAM,OAAE9B,QAAF,IAAEA,GAAF,UAAEA,EAAMK,gCAAR,iBAAE,EAAgCsB,gBAAlC,aAAE,EAA0CI,WAEpDxC,KAAMA,GAERyC,YAAa,SACXC,EADW,GAGP,IADFC,EACC,EADDA,gBAEF,UAAIA,QAAJ,IAAIA,OAAJ,EAAIA,EAAiB7B,yBAAyBC,MAAO,CAAC,IAAD,EAK/C4B,EAAgB7B,yBAHlBC,EAFiD,EAEjDA,MAIF,MAAO,CACLD,yBAA0B,CACxBsB,SAR+C,EAGjDA,SAMEQ,WAT+C,EAIjDA,WAME7B,MAAM,GAAD,mBACA2B,EAAoB5B,yBAAyBC,OAD7C,YAEAA,IAEL8B,WACEH,EAAoB5B,yBAAyB+B,aAKrD,OAAOH,MA+C0BI,SAAUpC,GACnC,gBAAC,IAAD,CAAYqC,MAAM,gBAAgBC,QAAQ,WACvCtC,EAAU,wBAAW,+BAMhC,gBAAC,IAAD,CAAauC,QAAM,EAACpC,UAAWT,EAAQzB,OAGrC,gBAAC,IAAD,CAAauE,MAAM,+DAOdnD","file":"static/js/15.38fa5fe2.chunk.js","sourcesContent":["import arrayWithoutHoles from \"./arrayWithoutHoles\";\nimport iterableToArray from \"./iterableToArray\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray\";\nimport nonIterableSpread from \"./nonIterableSpread\";\nexport default function _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}","import arrayLikeToArray from \"./arrayLikeToArray\";\nexport default function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}","export default function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}","export default function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","import * as React from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport {\n  FullScreen,\n  BodyScreen,\n  ContentScreen,\n  AiderScreen\n} from \"@/layouts/PageLayout\";\nimport {\n  Box,\n  GridList,\n  GridListTile,\n  Button,\n  Typography,\n  createStyles,\n  makeStyles,\n  Theme\n} from \"@material-ui/core\";\nimport { MediaNormal } from \"@/components/app/Media\";\nimport { SpecialBox } from \"@/components/public/SpecialBox\";\nimport {\n  useSearchShadowsPaginatedQuery,\n  SearchShadowsPaginatedQuery\n} from \"@/schema\";\nimport { useRouterHelper } from \"@/hooks\";\nimport { Placeholder } from \"@/components/base/Placeholder\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    content: {\n      margin: \"0 auto\",\n      padding: theme.spacing(8),\n      background: theme.palette.background.paper\n    },\n    aider: {\n      backgroundColor: theme.palette.background.paper,\n      width: \"100%\",\n      padding: theme.spacing(2, 2),\n      borderLeft: \"1px solid\",\n      borderColor: theme.palette.divider\n    },\n    gridRoot: {\n      display: \"grid\",\n      gridTemplateColumns: \"repeat(4, 1fr)\",\n      gridGap: theme.spacing(1, 1),\n      gridAutoFlow: \"row dense\"\n    },\n    gridCard: {\n      gridRow: \"1 span\",\n      gridColumn: \"1 span\"\n    },\n    footer: {\n      padding: theme.spacing(2),\n      textAlign: \"center\"\n    },\n    scollButton: {\n      position: \"fixed\",\n      right: theme.spacing(2),\n      bottom: theme.spacing(2)\n    }\n  })\n);\n\nexport const Search: React.FC = () => {\n  const { word } = useParams();\n  const RouterHelper = useRouterHelper();\n  const classes = useStyles();\n  const { data, loading, error, fetchMore } = useSearchShadowsPaginatedQuery({\n    variables: {\n      query: {\n        last: 16\n      },\n      word: word\n    }\n  });\n\n  const loadMore = () => {\n    fetchMore({\n      variables: {\n        query: {\n          last: 8,\n          before: data?.search_shadows_paginated?.pageInfo?.endCursor\n        },\n        word: word\n      },\n      updateQuery: (\n        previousQueryResult: SearchShadowsPaginatedQuery,\n        { fetchMoreResult }\n      ) => {\n        if (fetchMoreResult?.search_shadows_paginated.edges) {\n          const {\n            edges,\n            pageInfo,\n            totalCount\n          } = fetchMoreResult.search_shadows_paginated;\n          return {\n            search_shadows_paginated: {\n              pageInfo,\n              totalCount,\n              edges: [\n                ...previousQueryResult.search_shadows_paginated.edges,\n                ...edges\n              ],\n              __typename:\n                previousQueryResult.search_shadows_paginated.__typename\n            }\n          };\n        }\n\n        return previousQueryResult;\n      }\n    });\n  };\n\n  return (\n    <FullScreen>\n      <BodyScreen>\n        <ContentScreen className={classes.content}>\n          {data?.search_shadows_paginated?.edges?.length ? (\n            <Box className={classes.gridRoot}>\n              {data?.search_shadows_paginated?.edges?.map((edge: any) => {\n                return (\n                  <div key={edge.cursor} className={classes.gridCard}>\n                    <MediaNormal\n                      {...edge.node}\n                      onClickRoot={() => RouterHelper.gotoShadow(edge.node.id)}\n                      onClickAuthor={() =>\n                        RouterHelper.gotoProfile(edge.node.author.username)\n                      }\n                    />\n                  </div>\n                );\n              })}\n            </Box>\n          ) : (\n            <SpecialBox\n              loading={loading}\n              error={!!error}\n              placeholder\n              placeholderTitle=\"暂无搜索结果\"\n              loadingNode={\n                <GridList cellHeight=\"auto\" cols={4}>\n                  {[0, 0, 0, 0, 0, 0, 0, 0].map((_, index: number) => {\n                    return (\n                      <GridListTile key={index} cols={1}>\n                        <MediaNormal loading />\n                      </GridListTile>\n                    );\n                  })}\n                </GridList>\n              }\n            />\n          )}\n\n          {data?.search_shadows_paginated?.pageInfo?.hasNextPage && (\n            <Box className={classes.footer}>\n              <Button onClick={loadMore} disabled={loading}>\n                <Typography color=\"textSecondary\" variant=\"caption\">\n                  {loading ? \"加载中...\" : \"加载更多\"}\n                </Typography>\n              </Button>\n            </Box>\n          )}\n        </ContentScreen>\n        <AiderScreen sticky className={classes.aider}>\n          {/* <Sort /> */}\n          {/* <Filter /> */}\n          <Placeholder title=\"更多功能，敬请期待\" />\n        </AiderScreen>\n      </BodyScreen>\n    </FullScreen>\n  );\n};\n\nexport default Search;\n"],"sourceRoot":""}