{"version":3,"sources":["../node_modules/@material-ui/icons/esm/GitHub.js","views/auth/Login/modules/SignIn.tsx","views/auth/Login/modules/SignUp.tsx","views/auth/Login/modules/Swiper.tsx","views/auth/Login/index.tsx"],"names":["createSvgIcon","createElement","d","SignIn","useAuth","verify","setAccessToken","enqueueSnackbar","useSnackbar","React","username","setUsername","password","setPassword","usePlatformAuthWayQuery","thirdData","data","thirdLoading","loading","thirdError","error","useLoginMutation","onCompleted","login","onError","console","log","TextField","id","label","value","onChange","e","target","placeholder","fullWidth","margin","type","Button","variant","onClick","variables","disabled","platform_auth_way","map","item","idx","key","IconButton","platform","url","http_domain","top","window","screen","availHeight","left","availWidth","child","open","timer","setInterval","postMessage","addEventListener","event","clearInterval","close","access_token","thirdLogin","GitHub","email","setEmail","code","setCode","useHasUsernameQuery","useSendRegisterEmailMutation","send_register_email","useCreateUserWithCodeMutation","create_user_with_code","required","Box","user","AutoPlaySwipeableViews","autoPlay","SwipeableViews","useStyles","makeStyles","theme","createStyles","image","width","height","Swiper","props","classes","images","enableMouseEvents","index","i","className","Image","src","defaultProps","root","fontSize","overflow","flex","backgroundColor","palette","primary","main","right","background","paper","display","alignItems","justifyContent","Login","tag","setTag","_"],"mappings":"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","file":"static/js/19.cd2be2bb.chunk.js","sourcesContent":["import React from 'react';\nimport createSvgIcon from './utils/createSvgIcon';\nexport default createSvgIcon(React.createElement(\"path\", {\n  d: \"M12 .3a12 12 0 0 0-3.8 23.4c.6.1.8-.3.8-.6v-2c-3.3.7-4-1.6-4-1.6-.6-1.4-1.4-1.8-1.4-1.8-1-.7.1-.7.1-.7 1.2 0 1.9 1.2 1.9 1.2 1 1.8 2.8 1.3 3.5 1 0-.8.4-1.3.7-1.6-2.7-.3-5.5-1.3-5.5-6 0-1.2.5-2.3 1.3-3.1-.2-.4-.6-1.6 0-3.2 0 0 1-.3 3.4 1.2a11.5 11.5 0 0 1 6 0c2.3-1.5 3.3-1.2 3.3-1.2.6 1.6.2 2.8 0 3.2.9.8 1.3 1.9 1.3 3.2 0 4.6-2.8 5.6-5.5 5.9.5.4.9 1 .9 2.2v3.3c0 .3.1.7.8.6A12 12 0 0 0 12 .3\"\n}), 'GitHub');","import * as React from \"react\";\nimport { TextField, Button, IconButton } from \"@material-ui/core\";\nimport { useSnackbar } from \"notistack\";\nimport { useLoginMutation, usePlatformAuthWayQuery } from \"@/schema\";\nimport { useAuth } from \"@/hooks\";\nimport { GitHub } from \"@material-ui/icons\";\n\nexport default function SignIn() {\n  const { verify, setAccessToken } = useAuth();\n  const { enqueueSnackbar } = useSnackbar();\n  const [username, setUsername] = React.useState(\"\");\n  const [password, setPassword] = React.useState(\"\");\n  const {\n    data: thirdData,\n    loading: thirdLoading,\n    error: thirdError\n  } = usePlatformAuthWayQuery();\n  const [login, { loading }] = useLoginMutation({\n    onCompleted(data) {\n      enqueueSnackbar(\"登录成功\");\n      setAccessToken(data?.login);\n      verify();\n    },\n    onError(error) {\n      console.log(error);\n    }\n  });\n\n  const _signIn = function() {\n    login({ variables: { username, password } });\n  };\n\n  const thirdLogin = function(\n    platform: string,\n    url: string,\n    http_domain: string\n  ) {\n    const width = 450;\n    const height = 450;\n    const top = (window.screen.availHeight - height) / 2;\n    const left = (window.screen.availWidth - width) / 2;\n    const child = window.open(\n      http_domain + url,\n      platform,\n      `width=${width},height=${height},top=${top},left=${left},toolbar=0,menubar=0,location=0,status=0`\n    );\n    if (child) {\n      const timer = setInterval(() => {\n        child.postMessage(\n          {\n            type: \"access_token\"\n          },\n          http_domain\n        );\n      }, 1000);\n\n      window.addEventListener(\"message\", event => {\n        const data = event.data;\n        if (data && data.type === \"access_token_callback\") {\n          clearInterval(timer);\n          child && child.close();\n          enqueueSnackbar(\n            data.data.access_token ? \"登录成功\" : data.data.error || \"登录失败\"\n          );\n          setAccessToken(data.data.access_token);\n          verify();\n        }\n      });\n    }\n  };\n\n  React.useEffect(() => {\n    verify();\n  });\n\n  return (\n    <div>\n      <form>\n        <TextField\n          id=\"username\"\n          label=\"用户名\"\n          value={username}\n          onChange={e => setUsername(e.target.value)}\n          placeholder=\"请输入用户名\"\n          fullWidth\n          margin=\"normal\"\n        />\n        <TextField\n          id=\"password\"\n          label=\"密码\"\n          type=\"password\"\n          value={password}\n          onChange={e => setPassword(e.target.value)}\n          placeholder=\"请输入密码\"\n          fullWidth\n          margin=\"normal\"\n        />\n        <Button variant=\"contained\" onClick={_signIn} disabled={loading}>\n          {loading ? \"登录中\" : \"登录\"}\n        </Button>\n      </form>\n      {thirdData?.platform_auth_way.map((item, idx) => {\n        return (\n          <div key={idx}>\n            <IconButton\n              onClick={() =>\n                thirdLogin(item.platform, item.url, item.http_domain)\n              }\n            >\n              {item.platform === \"github\" && <GitHub />}\n            </IconButton>\n          </div>\n        );\n      })}\n      {thirdLoading && <div>loading</div>}\n      {thirdError && <div>error</div>}\n    </div>\n  );\n}\n","import * as React from \"react\";\nimport { TextField, Button, Box } from \"@material-ui/core\";\nimport { useSnackbar } from \"notistack\";\nimport {\n  useHasUsernameQuery,\n  useSendRegisterEmailMutation,\n  useCreateUserWithCodeMutation\n} from \"@/schema\";\nimport { useAuth } from \"@/hooks\";\n\nexport default function SignIn() {\n  const { verify } = useAuth();\n  const { enqueueSnackbar } = useSnackbar();\n  const [username, setUsername] = React.useState(\"\");\n  const [password, setPassword] = React.useState(\"\");\n  const [email, setEmail] = React.useState(\"\");\n  const [code, setCode] = React.useState(\"\");\n\n  const { data, loading } = useHasUsernameQuery({\n    variables: {\n      username: username\n    }\n  });\n  console.log(\"_changeUsername: \", username, data, loading);\n\n  // 发送验证码\n  const [send_register_email] = useSendRegisterEmailMutation({\n    onCompleted() {\n      enqueueSnackbar(\"发送成功\");\n    }\n  });\n  const _sendVerifyCode = function() {\n    send_register_email({ variables: { email: email } });\n  };\n\n  // 注册\n  const [create_user_with_code] = useCreateUserWithCodeMutation({\n    onCompleted(data) {\n      enqueueSnackbar(\"注册成功\");\n      verify();\n    }\n  });\n  const _signUp = () => {\n    create_user_with_code({\n      variables: {\n        user: {\n          username,\n          password,\n          email,\n          code\n        }\n      }\n    });\n  };\n\n  const _changeUsername = (\n    e: React.ChangeEvent<HTMLTextAreaElement | HTMLInputElement>\n  ) => {\n    setUsername(e.target.value);\n  };\n\n  React.useEffect(() => {\n    verify();\n  });\n\n  return (\n    <div>\n      <form>\n        <TextField\n          id=\"username\"\n          label=\"用户名\"\n          required\n          value={username}\n          onChange={_changeUsername}\n          placeholder=\"请输入用户名\"\n          fullWidth\n          margin=\"normal\"\n        />\n        <TextField\n          id=\"password\"\n          label=\"密码\"\n          type=\"password\"\n          required\n          value={password}\n          onChange={e => setPassword(e.target.value)}\n          placeholder=\"请输入密码\"\n          fullWidth\n          margin=\"normal\"\n        />\n        <TextField\n          id=\"email\"\n          label=\"邮箱\"\n          type=\"email\"\n          required\n          value={email}\n          onChange={e => setEmail(e.target.value)}\n          placeholder=\"请输入邮箱\"\n          fullWidth\n          margin=\"normal\"\n        />\n        <Box>\n          <TextField\n            id=\"code\"\n            label=\"验证码\"\n            value={code}\n            onChange={e => setCode(e.target.value)}\n            placeholder=\"请输入验证码\"\n            margin=\"normal\"\n          />\n          <Button variant=\"contained\" onClick={_sendVerifyCode}>\n            获取验证码\n          </Button>\n        </Box>\n        <Button variant=\"contained\" fullWidth onClick={_signUp}>\n          注册\n        </Button>\n      </form>\n    </div>\n  );\n}\n","import * as React from \"react\";\nimport SwipeableViews from \"react-swipeable-views\";\nimport { autoPlay } from \"react-swipeable-views-utils\";\nimport Image from \"@/components/base/Image\";\nimport { makeStyles, createStyles, Theme } from \"@material-ui/core/styles\";\n\nconst AutoPlaySwipeableViews = autoPlay(SwipeableViews);\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    image: {\n      width: \"100%\",\n      height: \"100%\"\n    }\n  })\n);\n\ninterface SwiperProps {\n  images: string[];\n}\n\nfunction Swiper(props: SwiperProps) {\n  const classes = useStyles();\n  const { images } = props;\n\n  return (\n    <div>\n      <AutoPlaySwipeableViews enableMouseEvents index={0}>\n        {images.map((item, i) => {\n          return (\n            <div className={classes.image} key={i}>\n              <Image src={item} />\n            </div>\n          );\n        })}\n      </AutoPlaySwipeableViews>\n    </div>\n  );\n}\n\nSwiper.defaultProps = {\n  images: [\n    \"https://pic1.zhimg.com/v2-cc17d8b31fe162fdbfadba1d18b7836e_1200x500.jpg\",\n    \"http://n.sinaimg.cn/collect/crawl/20160224/ZFh0-fxprucv9824132.jpg\"\n  ]\n} as Partial<SwiperProps>;\n\nexport default Swiper;\n","import * as React from \"react\";\nimport { SignIn, SignUp, Swiper } from \"./modules\";\nimport { Button, Box } from \"@material-ui/core\";\nimport { makeStyles, Theme, createStyles } from \"@material-ui/core/styles\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      width: \"100%\",\n      height: \"100vh\",\n      fontSize: 0,\n      overflow: \"hidden\"\n    },\n    left: {\n      flex: 1,\n      backgroundColor: theme.palette.primary.main\n    },\n    right: {\n      flex: 1,\n      backgroundColor: theme.palette.background.paper,\n      display: \"flex\",\n      alignItems: \"center\",\n      justifyContent: \"center\"\n    },\n    main: {\n      width: 300\n    }\n  })\n);\n\nexport default function Login() {\n  const classes = useStyles();\n  const [tag, setTag] = React.useState(0);\n\n  return (\n    <Box className={classes.root} display=\"flex\">\n      <div className={classes.left}>\n        <Swiper />\n      </div>\n      <div className={classes.right}>\n        <div className={classes.main}>\n          <Button onClick={_ => setTag(0)}>登录</Button>\n          <Button onClick={_ => setTag(1)}>注册</Button>\n          <div>\n            {tag === 0 && <SignIn />}\n            {tag === 1 && <SignUp />}\n          </div>\n        </div>\n      </div>\n    </Box>\n  );\n}\n"],"sourceRoot":""}